
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ST-1101-gif.github.io/notes/cs61a%20notes/chap2/">
      
      
        <link rel="prev" href="../chap1/">
      
      
        <link rel="next" href="../chap3/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19">
    
    
      
        <title>Chap2 - 雨33的notebook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter_2_building_abstractions_with_data" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="雨33的notebook" class="md-header__button md-logo" aria-label="雨33的notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            雨33的notebook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chap2
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cs161/principles/" class="md-tabs__link">
          
  
  
  Computer Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../web/intro/" class="md-tabs__link">
          
  
  
  Internet

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../linux/shell/" class="md-tabs__link">
          
  
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../linux/regular%20expression/" class="md-tabs__link">
        
  
  
    
  
  Regular Expression

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../git/git/" class="md-tabs__link">
        
  
  
    
  
  Git

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../Go/syntax/" class="md-tabs__link">
        
  
  
    
  
  Go

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../chap1/" class="md-tabs__link">
          
  
  
  python

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cs61b%20notes/java/" class="md-tabs__link">
          
  
  
  DS

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../SQL/MySQL/" class="md-tabs__link">
          
  
  
  SQL

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="雨33的notebook" class="md-nav__button md-logo" aria-label="雨33的notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    雨33的notebook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Computer Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computer Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/principles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Principles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cryptography
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Cryptography
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/Cryptography/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/Cryptography/symmetric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Symmetric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/Cryptography/hash/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/Cryptography/asymmetric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Asymmetric
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Memory Safety
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Memory Safety
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/memory%20safety/x86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    x86 Assembly
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs161/memory%20safety/vulnerabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vulnerabilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Web Security
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Web Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasp/csrf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CSRF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasp/xss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    XSS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasp/sql%20injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasp/command%20injection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command Injection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasp/File%20Inclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Inclusion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owasp/File%20Upload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Upload
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Internet
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Internet
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web/transport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transport
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web/applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../web/end-to-end/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    End-to-End
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/vim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vim
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/regular%20expression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regular Expression
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Go/syntax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Go
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    python
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chap1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Chap2
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Chap2
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter_2_building_abstractions_with_data" class="md-nav__link">
    <span class="md-ellipsis">
      Chapter 2: Building Abstractions with Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22_data_abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Data Abstraction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 Data Abstraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abstraction_barriers" class="md-nav__link">
    <span class="md-ellipsis">
      Abstraction Barriers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_properties_of_data" class="md-nav__link">
    <span class="md-ellipsis">
      The Properties of Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Sequences
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 Sequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequence_iteration" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_processing" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Abstraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    <span class="md-ellipsis">
      Strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trees" class="md-nav__link">
    <span class="md-ellipsis">
      Trees
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trees">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#representation" class="md-nav__link">
    <span class="md-ellipsis">
      representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulate" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked_lists" class="md-nav__link">
    <span class="md-ellipsis">
      Linked Lists
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linked Lists">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#representation_1" class="md-nav__link">
    <span class="md-ellipsis">
      representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recursive_manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      Recursive manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recursive_construction" class="md-nav__link">
    <span class="md-ellipsis">
      Recursive Construction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#24_mutable_data" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Mutable Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Mutable Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the_object_metaphor" class="md-nav__link">
    <span class="md-ellipsis">
      The Object Metaphor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_objects" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sequence Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    <span class="md-ellipsis">
      List
    </span>
  </a>
  
    <nav class="md-nav" aria-label="List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lists_in_environment_diagrams" class="md-nav__link">
    <span class="md-ellipsis">
      lists in environment diagrams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharing_and_identity" class="md-nav__link">
    <span class="md-ellipsis">
      Sharing and Identity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuples" class="md-nav__link">
    <span class="md-ellipsis">
      Tuples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Dictionaries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default_mutable_argument" class="md-nav__link">
    <span class="md-ellipsis">
      Default Mutable Argument
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local_state" class="md-nav__link">
    <span class="md-ellipsis">
      Local State
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_benefits_of_non-local_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      The Benefits of Non-Local Assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_cost_of_non-local_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      The Cost of Non-Local Assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing_lists_and_dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Lists and Dictionaries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing Lists and Dictionaries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing_dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Dictionaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dispatch_dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Dispatch Dictionaries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagating_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Propagating Constraints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Propagating Constraints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using_the_constraint_system" class="md-nav__link">
    <span class="md-ellipsis">
      Using the Constraint System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing_the_constraint_system" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing the Constraint System
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#25_object-oriented_programming" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Object-Oriented Programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.5 Object-Oriented Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objects_and_classes" class="md-nav__link">
    <span class="md-ellipsis">
      Objects and Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining_classes" class="md-nav__link">
    <span class="md-ellipsis">
      Defining Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message_passing_and_dot_expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Message Passing and Dot Expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class_attributes_class_variables_static_variables" class="md-nav__link">
    <span class="md-ellipsis">
      Class Attributes / Class Variables / Static Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using_inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Using Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple_inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_role_of_objects" class="md-nav__link">
    <span class="md-ellipsis">
      The Role of Objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#26_implementing_classes_and_objects" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 Implementing Classes and Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#27_object_abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 Object Abstraction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.7 Object Abstraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string_conversion" class="md-nav__link">
    <span class="md-ellipsis">
      String Conversion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string_interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      String Interpolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special_methods" class="md-nav__link">
    <span class="md-ellipsis">
      Special Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Special Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#true_and_false_values" class="md-nav__link">
    <span class="md-ellipsis">
      True and false values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_operations" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callable_objects" class="md-nav__link">
    <span class="md-ellipsis">
      Callable objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Arithmetic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple_representations" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Representations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic_functions" class="md-nav__link">
    <span class="md-ellipsis">
      Generic Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generic Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type_dispatching" class="md-nav__link">
    <span class="md-ellipsis">
      type dispatching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type_coercion" class="md-nav__link">
    <span class="md-ellipsis">
      type coercion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#28_efficiency" class="md-nav__link">
    <span class="md-ellipsis">
      2.8 Efficiency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#29_recursive_objects" class="md-nav__link">
    <span class="md-ellipsis">
      2.9 Recursive Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.9 Recursive Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#link_class" class="md-nav__link">
    <span class="md-ellipsis">
      Link Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Link Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manipulate_link" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate link
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree_class" class="md-nav__link">
    <span class="md-ellipsis">
      Tree Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tree Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manipulate_tree" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sets" class="md-nav__link">
    <span class="md-ellipsis">
      Sets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chap3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chap4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chap4
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            DS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cs61b%20notes/java/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Java
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    SQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SQL/MySQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MySQL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter_2_building_abstractions_with_data" class="md-nav__link">
    <span class="md-ellipsis">
      Chapter 2: Building Abstractions with Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22_data_abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Data Abstraction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.2 Data Abstraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abstraction_barriers" class="md-nav__link">
    <span class="md-ellipsis">
      Abstraction Barriers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_properties_of_data" class="md-nav__link">
    <span class="md-ellipsis">
      The Properties of Data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23_sequences" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 Sequences
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 Sequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequence_iteration" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_processing" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Abstraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    <span class="md-ellipsis">
      Strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trees" class="md-nav__link">
    <span class="md-ellipsis">
      Trees
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trees">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#representation" class="md-nav__link">
    <span class="md-ellipsis">
      representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manipulate" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linked_lists" class="md-nav__link">
    <span class="md-ellipsis">
      Linked Lists
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linked Lists">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#representation_1" class="md-nav__link">
    <span class="md-ellipsis">
      representation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recursive_manipulation" class="md-nav__link">
    <span class="md-ellipsis">
      Recursive manipulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recursive_construction" class="md-nav__link">
    <span class="md-ellipsis">
      Recursive Construction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#24_mutable_data" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 Mutable Data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 Mutable Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the_object_metaphor" class="md-nav__link">
    <span class="md-ellipsis">
      The Object Metaphor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_objects" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sequence Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    <span class="md-ellipsis">
      List
    </span>
  </a>
  
    <nav class="md-nav" aria-label="List">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lists_in_environment_diagrams" class="md-nav__link">
    <span class="md-ellipsis">
      lists in environment diagrams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharing_and_identity" class="md-nav__link">
    <span class="md-ellipsis">
      Sharing and Identity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuples" class="md-nav__link">
    <span class="md-ellipsis">
      Tuples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Dictionaries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default_mutable_argument" class="md-nav__link">
    <span class="md-ellipsis">
      Default Mutable Argument
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local_state" class="md-nav__link">
    <span class="md-ellipsis">
      Local State
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_benefits_of_non-local_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      The Benefits of Non-Local Assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_cost_of_non-local_assignment" class="md-nav__link">
    <span class="md-ellipsis">
      The Cost of Non-Local Assignment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing_lists_and_dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Lists and Dictionaries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing Lists and Dictionaries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing_dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing Dictionaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dispatch_dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      Dispatch Dictionaries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagating_constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Propagating Constraints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Propagating Constraints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using_the_constraint_system" class="md-nav__link">
    <span class="md-ellipsis">
      Using the Constraint System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementing_the_constraint_system" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing the Constraint System
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#25_object-oriented_programming" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 Object-Oriented Programming
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.5 Object-Oriented Programming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objects_and_classes" class="md-nav__link">
    <span class="md-ellipsis">
      Objects and Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining_classes" class="md-nav__link">
    <span class="md-ellipsis">
      Defining Classes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#message_passing_and_dot_expressions" class="md-nav__link">
    <span class="md-ellipsis">
      Message Passing and Dot Expressions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class_attributes_class_variables_static_variables" class="md-nav__link">
    <span class="md-ellipsis">
      Class Attributes / Class Variables / Static Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using_inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Using Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple_inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Inheritance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the_role_of_objects" class="md-nav__link">
    <span class="md-ellipsis">
      The Role of Objects
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#26_implementing_classes_and_objects" class="md-nav__link">
    <span class="md-ellipsis">
      2.6 Implementing Classes and Objects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#27_object_abstraction" class="md-nav__link">
    <span class="md-ellipsis">
      2.7 Object Abstraction
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.7 Object Abstraction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#string_conversion" class="md-nav__link">
    <span class="md-ellipsis">
      String Conversion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#string_interpolation" class="md-nav__link">
    <span class="md-ellipsis">
      String Interpolation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#special_methods" class="md-nav__link">
    <span class="md-ellipsis">
      Special Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Special Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#true_and_false_values" class="md-nav__link">
    <span class="md-ellipsis">
      True and false values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sequence_operations" class="md-nav__link">
    <span class="md-ellipsis">
      Sequence operations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callable_objects" class="md-nav__link">
    <span class="md-ellipsis">
      Callable objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Arithmetic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple_representations" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple Representations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic_functions" class="md-nav__link">
    <span class="md-ellipsis">
      Generic Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generic Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type_dispatching" class="md-nav__link">
    <span class="md-ellipsis">
      type dispatching
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type_coercion" class="md-nav__link">
    <span class="md-ellipsis">
      type coercion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#28_efficiency" class="md-nav__link">
    <span class="md-ellipsis">
      2.8 Efficiency
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#29_recursive_objects" class="md-nav__link">
    <span class="md-ellipsis">
      2.9 Recursive Objects
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.9 Recursive Objects">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#link_class" class="md-nav__link">
    <span class="md-ellipsis">
      Link Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Link Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manipulate_link" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate link
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree_class" class="md-nav__link">
    <span class="md-ellipsis">
      Tree Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tree Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manipulate_tree" class="md-nav__link">
    <span class="md-ellipsis">
      manipulate tree
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sets" class="md-nav__link">
    <span class="md-ellipsis">
      Sets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Chap2</h1>

<h2 id="chapter_2_building_abstractions_with_data"><center> Chapter 2: Building Abstractions with Data<a class="headerlink" href="#chapter_2_building_abstractions_with_data" title="Permanent link">&para;</a></h2>
<!-- pagebreak -->

<hr />
<h2 id="22_data_abstraction">2.2 Data Abstraction<a class="headerlink" href="#22_data_abstraction" title="Permanent link">&para;</a></h2>
<hr />
<p>a <strong>compound data</strong> value can be manipulate as a single conceptual unit, but also has two parts that can be considered individually.</p>
<p>The general technique of isolating the parts of a program that deal with how data are <em>represented</em> from the parts that deal with how data are <em>manipulated</em> is a powerful design methodology called <strong>data abstraction</strong>.</p>
<p>These two parts of a program are connected by a small set of functions that implement <strong>abstract data</strong> in terms of the <strong>concrete representation</strong>.</p>
<blockquote>
<p>Example: Rational Numbers
- representation:
    constructor
    - <code>rational(n, d)</code> returns the rational number with numerator n and denominator d.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>selectors
- `numer(x)` returns the numerator of the rational number x.
- `denom(x)` returns the denominator of the rational number x.
</code></pre></div>
<ul>
<li>manipulate
<strong>wishful thinking</strong>: We haven't yet said how a rational number is represented. Even so, we could then add, multiply, print, and test equality of rational numbers:</li>
</ul>
<div class="highlight"><pre><span></span><code><span id="True-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_rationals</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="True-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>        <span class="n">nx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="True-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>        <span class="n">ny</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">numer</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="True-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>        <span class="k">return</span> <span class="n">rational</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="True-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">mul_rationals</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="True-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>        <span class="k">return</span> <span class="n">rational</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">numer</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="True-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">print_rational</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>  
</span><span id="True-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="True-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">rationals_are_equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="True-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>        <span class="k">return</span> <span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">numer</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="abstraction_barriers">Abstraction Barriers<a class="headerlink" href="#abstraction_barriers" title="Permanent link">&para;</a></h3>
<p>occur whenever a part of the program that can use a higher level function instead uses a function in a lower level.
<div class="highlight"><pre><span></span><code><span id="True-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">square_rational</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="True-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>        <span class="k">return</span> <span class="n">mul_rational</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="True-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">square_rational_violating_once</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="True-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;violate one abstraction barrier.&#39;&#39;&#39;</span>
</span><span id="True-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="k">return</span> <span class="n">rational</span><span class="p">(</span><span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">numer</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">denom</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="True-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">square_rational_violating_twice</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="True-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;violate two abstraction barrier.&#39;&#39;&#39;</span>
</span><span id="True-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</span></code></pre></div></p>
<h3 id="the_properties_of_data">The Properties of Data<a class="headerlink" href="#the_properties_of_data" title="Permanent link">&para;</a></h3>
<p>implement data as <em>functions</em>
<div class="highlight"><pre><span></span><code><span id="True-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">pair</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>     <span class="c1"># constructor </span>
</span><span id="True-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a function that represents a pair.&quot;&quot;&quot;</span>
</span><span id="True-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>     <span class="c1"># selector</span>
</span><span id="True-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>                <span class="k">return</span> <span class="n">x</span>
</span><span id="True-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="True-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>                <span class="k">return</span> <span class="n">y</span>
</span><span id="True-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>        <span class="k">return</span> <span class="n">get</span>
</span><span id="True-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="True-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the element at index i of pair p.&quot;&quot;&quot;</span>
</span><span id="True-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>        <span class="k">return</span> <span class="n">p</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>     <span class="c1"># call itself</span>
</span><span id="True-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">pair</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
</span><span id="True-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="True-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="mi">20</span>
</span><span id="True-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">select</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="True-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="mi">14</span>
</span></code></pre></div></p>
<hr />
<h2 id="23_sequences">2.3   Sequences<a class="headerlink" href="#23_sequences" title="Permanent link">&para;</a></h2>
<hr />
<p>share common behavior:
- <strong>Length</strong>
- <strong>Element selection</strong>
- addition and multiplication: combine and replicate</p>
<h3 id="sequence_iteration">Sequence Iteration<a class="headerlink" href="#sequence_iteration" title="Permanent link">&para;</a></h3>
<p><div class="highlight"><pre><span></span><code><span id="True-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>for &lt;name&gt; in &lt;expression&gt;:
</span><span id="True-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    &lt;suite&gt;
</span></code></pre></div>
executed by the following procedure:
1. Evaluate the header <code>&lt;expression&gt;</code>, which must yield an iterable value.
2. For each element value in that iterable value, in order:
   1. Bind <code>&lt;name&gt;</code> to that value in the current frame.
   2. Execute the <code>&lt;suite&gt;</code>.
<div class="highlight"><pre><span></span><code><span id="True-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</span><span id="True-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="True-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>        <span class="n">s</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span><span id="True-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
</span><span id="True-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span></code></pre></div>
- <name> will be bound to the <em>last element</em> of the sequence after the for statement is executed. 
introduces yet another way in which the <em>environment can be updated by a statement</em>.</p>
<p><strong>Sequence unpacking</strong>
binding <em>multiple</em> names to <em>multiple</em> values in a fixed-length sequence
<div class="highlight"><pre><span></span><code><span id="True-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</span><span id="True-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">numbers</span>
</span></code></pre></div></p>
<p><div class="highlight"><pre><span></span><code><span id="True-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">pairs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</span><span id="True-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
</span><span id="True-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">:</span>
</span><span id="True-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>        <span class="n">same_count</span> <span class="o">=</span> <span class="n">same_count</span> <span class="o">+</span> <span class="mi">1</span>
</span></code></pre></div>
<strong>Ranges</strong>
<div class="highlight"><pre><span></span><code><span id="True-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>range(stop)
</span><span id="True-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>range(start, stop)
</span><span id="True-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>range(start, stop, step)
</span></code></pre></div>
commonly appear as the expression in a <code>for</code> header to specify the number of times that the suite should be executed
use <code>_</code> for the name in the for header if the name is <em>unused</em> in the suite</p>
<h3 id="sequence_processing">Sequence Processing<a class="headerlink" href="#sequence_processing" title="Permanent link">&para;</a></h3>
<p><strong>List Comprehensions</strong>
<div class="highlight"><pre><span></span><code><span id="True-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>[&lt;map expression&gt; for &lt;name&gt; in &lt;sequence expression&gt; if &lt;filter expression&gt;]
</span></code></pre></div>
1. evaluates the <code>&lt;sequence expression&gt;</code>, which must return an iterable value. 
2. for each element, in order
    1. the element value is bound to <name>
    2. the filter expression is evaluated
    if it yields a true value:
       - the map expression is evaluated. 
       - The values of the map expression are collected into a list.</p>
<p><strong>Aggregation</strong>
aggregate all values in a sequence into a single value
built-in: <code>sum</code>, <code>min</code>, <code>max</code>, <code>all</code></p>
<ul>
<li>sum(iterable[, start]) &rarr; value</li>
<li>max(iterable[, <strong>key = func</strong>]) &rarr; value
  <div class="highlight"><pre><span></span><code><span id="True-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">max</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
</span></code></pre></div></li>
<li>all(iterable) &rarr; bool
  <div class="highlight"><pre><span></span><code><span id="True-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nb">all</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>
</span></code></pre></div></li>
</ul>
<p><strong>Higher-Order Functions</strong>
<div class="highlight"><pre><span></span><code><span id="True-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_to_all</span><span class="p">(</span><span class="n">map_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="True-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">map_fn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
</span><span id="True-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
</span><span id="True-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">keep_if</span><span class="p">(</span><span class="n">filter_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="True-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span> <span class="k">if</span> <span class="n">filter_fn</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</span><span id="True-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
</span><span id="True-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">reduce</span><span class="p">(</span><span class="n">reduce_fn</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">initial</span><span class="p">):</span>
</span><span id="True-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="n">reduced</span> <span class="o">=</span> <span class="n">initial</span>
</span><span id="True-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span><span id="True-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>        <span class="n">reduced</span> <span class="o">=</span> <span class="n">reduce_fn</span><span class="p">(</span><span class="n">reduced</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="True-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    <span class="k">return</span> <span class="n">reduced</span>
</span></code></pre></div>
built-in function: <code>map</code>, <code>filter</code>, <code>reduce</code></p>
<h3 id="sequence_abstraction">Sequence Abstraction<a class="headerlink" href="#sequence_abstraction" title="Permanent link">&para;</a></h3>
<p><strong>Membership</strong>
<code>in</code></p>
<p><strong>Slicing</strong></p>
<h3 id="strings">Strings<a class="headerlink" href="#strings" title="Permanent link">&para;</a></h3>
<p>The <strong>elements</strong> of a string are themselves strings that have only a single character.
Python does not have a separate character type</p>
<p><strong>Membership</strong>
<code>in</code> matches <strong>substrings</strong> rather than elements.</p>
<p><strong>Multiline Literals</strong> 
triple quotes</p>
<p><strong>String Coercion</strong>
A string can be created from any object in Python by calling the str constructor function with an object value as its argument.</p>
<h3 id="trees">Trees<a class="headerlink" href="#trees" title="Permanent link">&para;</a></h3>
<ul>
<li>a <em>method for combining data values</em> has a <strong>closure property</strong> if the result of combination can itself be combined using the same method</li>
<li>it permits us to create <strong>hierarchical structures</strong>— structures made up of parts, which themselves are made up of parts, and so on.</li>
<li>The <strong>tree</strong> is a fundamental <em>data abstraction</em> that imposes regularity on how hierarchical values are structured and manipulated.</li>
</ul>
<h4 id="representation">representation<a class="headerlink" href="#representation" title="Permanent link">&para;</a></h4>
<p>The data abstraction for a tree consists of the <strong>constructor</strong> <code>tree</code> and the <strong>selectors</strong> <code>label</code> and <code>branches</code>.</p>
<p><div class="highlight"><pre><span></span><code><span id="True-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">tree</span><span class="p">(</span><span class="n">root_label</span><span class="p">,</span> <span class="n">branches</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="True-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>    <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
</span><span id="True-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>        <span class="k">assert</span> <span class="n">is_tree</span><span class="p">(</span><span class="n">branch</span><span class="p">),</span> <span class="s1">&#39;branches must be trees&#39;</span>
</span><span id="True-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">root_label</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="p">)</span>
</span><span id="True-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    <span class="c1">#  if branches is a list, this statement is equivalent to </span>
</span><span id="True-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>    <span class="c1"># `return [root_lable] + branches` </span>
</span><span id="True-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
</span><span id="True-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">label</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
</span><span id="True-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
</span><span id="True-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>    <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span></code></pre></div>
A tree is <strong>well-formed</strong> only if it has a root label and all branches are also trees.
<div class="highlight"><pre><span></span><code><span id="True-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="True-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="True-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_tree</span><span class="p">(</span><span class="n">branch</span><span class="p">):</span>
</span><span id="True-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="True-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>    <span class="k">return</span> <span class="kc">True</span>
</span></code></pre></div>
checks whether or not a tree has branches:
<div class="highlight"><pre><span></span><code><span id="True-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>    <span class="k">return</span> <span class="ow">not</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</span></code></pre></div>
⚠️before calling is_leaf / lable / branch, must make sure the parameter <em>is a tree</em> ! (using <code>assert</code> to test...)</p>
<h4 id="manipulate">manipulate<a class="headerlink" href="#manipulate" title="Permanent link">&para;</a></h4>
<ul>
<li>nested expressions
<div class="highlight"><pre><span></span><code><span id="True-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">tree</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tree</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">tree</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tree</span><span class="p">(</span><span class="mi">1</span><span class="p">)])])</span>
</span><span id="True-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span>
</span><span id="True-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
</span></code></pre></div></li>
<li>tree-recursive functions<blockquote>
<p>Fibonacci tree
<div class="highlight"><pre><span></span><code><span id="True-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">fib_tree</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="True-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="True-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="True-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">fib_tree</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">fib_tree</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="True-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>            <span class="n">fib_n</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">+</span> <span class="n">label</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>
</span><span id="True-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>            <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="n">fib_n</span><span class="p">,</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span>
</span><span id="True-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fib_tree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span id="True-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]]]</span>
</span></code></pre></div></p>
<p>Partition trees
<div class="highlight"><pre><span></span><code><span id="True-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">partition_tree</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span><span id="True-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a partition tree of n using parts of up to m.&quot;&quot;&quot;</span>
</span><span id="True-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>        <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="True-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>        <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="True-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="True-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>        <span class="n">left</span> <span class="o">=</span> <span class="n">partition_tree</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="True-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>        <span class="n">right</span> <span class="o">=</span> <span class="n">partition_tree</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="True-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>        <span class="k">return</span> <span class="n">tree</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="p">[</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">print_parts</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">partition</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="True-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>        <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>        <span class="k">if</span> <span class="n">label</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">partition</span><span class="p">))</span>
</span><span id="True-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">branches</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
</span><span id="True-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>            <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">label</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
</span><span id="True-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>            <span class="n">print_parts</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">partition</span> <span class="o">+</span> <span class="p">[</span><span class="n">m</span><span class="p">])</span>
</span><span id="True-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>            <span class="n">print_parts</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">partition</span><span class="p">)</span>
</span><span id="True-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">print_parts</span><span class="p">(</span><span class="n">partition_tree</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="True-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="True-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="True-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span>
</span><span id="True-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="True-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="True-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span>
</span><span id="True-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="True-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="True-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
</span></code></pre></div>
binarization</p>
</blockquote>
</li>
</ul>
<p>A common tree transformation called <strong>binarization</strong> computes a <strong>binary tree</strong> from an original tree by grouping together adjacent branches.</p>
<div class="highlight"><pre><span></span><code><span id="True-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">right_binarize</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a right-branching binary tree.&quot;&quot;&quot;</span>
</span><span id="True-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>        <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
</span><span id="True-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>            <span class="k">return</span> <span class="n">tree</span>
</span><span id="True-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="True-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>            <span class="n">tree</span> <span class="o">=</span> <span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span id="True-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>            <span class="k">return</span> <span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="n">right_binarize</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">tree</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
</span><span id="True-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">right_binarize</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</span><span id="True-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]]]]]</span>
</span></code></pre></div>
<h3 id="linked_lists">Linked Lists<a class="headerlink" href="#linked_lists" title="Permanent link">&para;</a></h3>
<p>A common representation(not built-in) of a sequence constructed from <em>nested pairs</em> is called a <strong>linked list</strong>.</p>
<p><img alt="" src="../linked_list.png" /></p>
<h4 id="representation_1">representation<a class="headerlink" href="#representation_1" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>A linked list is a pair containing the <code>first element</code> of the sequence and the <code>rest</code> of the sequence. The second element is also a linked list. </p>
</li>
<li>
<p>The rest of the inner-most linked list containing only 4 is <strong>'empty'</strong>, a value that represents an empty linked list.</p>
</li>
</ul>
<p>&rarr; <em>recursive</em>!
<div class="highlight"><pre><span></span><code><span id="True-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">empty</span> <span class="o">=</span> <span class="s1">&#39;empty&#39;</span>
</span><span id="True-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>
</span><span id="True-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="True-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;s is a linked list if it is `empty` or a (first, rest) pair.&quot;&quot;&quot;</span>
</span><span id="True-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>    <span class="k">return</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="True-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="True-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">link</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="p">):</span>
</span><span id="True-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructor&quot;&quot;&quot;</span>
</span><span id="True-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">rest</span><span class="p">),</span> <span class="s2">&quot;rest must be a linked list.&quot;</span>
</span><span id="True-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="p">]</span>
</span><span id="True-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>
</span><span id="True-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">first</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="True-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Selector `first element`&quot;&quot;&quot;</span>
</span><span id="True-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>    <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s2">&quot;first only applies to linked lists.&quot;</span>
</span><span id="True-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>    <span class="k">assert</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">empty</span><span class="p">,</span> <span class="s2">&quot;empty linked list has no first element.&quot;</span>
</span><span id="True-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>    <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="True-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>
</span><span id="True-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">rest</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="True-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Selector `rest`&quot;&quot;&quot;</span>
</span><span id="True-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>    <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="s2">&quot;rest only applies to linked lists.&quot;</span>
</span><span id="True-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>    <span class="k">assert</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">empty</span><span class="p">,</span> <span class="s2">&quot;empty linked list has no rest.&quot;</span>
</span><span id="True-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>    <span class="k">return</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></code></pre></div>
construct:
<div class="highlight"><pre><span></span><code><span id="True-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="n">four</span> <span class="o">=</span> <span class="n">link</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">link</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">link</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">link</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">empty</span><span class="p">))))</span>
</span></code></pre></div></p>
<p>linked list satisfies the <strong>sequence abstraction</strong>:
<div class="highlight"><pre><span></span><code><span id="True-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">len_link</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="True-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;length&quot;&quot;&quot;</span>
</span><span id="True-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>    <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="True-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>    <span class="k">while</span> <span class="n">s</span> <span class="o">!=</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>        <span class="n">s</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">length</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="True-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>    <span class="k">return</span> <span class="n">length</span>
</span><span id="True-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>
</span><span id="True-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">getitem_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="True-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;element selection&quot;&quot;&quot;</span>
</span><span id="True-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>        <span class="n">s</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="True-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>    <span class="k">return</span> <span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></code></pre></div></p>
<h4 id="recursive_manipulation">Recursive manipulation<a class="headerlink" href="#recursive_manipulation" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span id="True-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">len_link_recursive</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="True-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>        <span class="k">return</span> <span class="mi">0</span>
</span><span id="True-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>    <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">len_link_recursive</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</span><span id="True-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
</span><span id="True-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">getitem_link_recursive</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="True-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>        <span class="k">return</span> <span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="True-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>    <span class="k">return</span> <span class="n">getitem_link_recursive</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">extend_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
</span><span id="True-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list with the elements of s followed by those of t.&quot;&quot;&quot;</span>
</span><span id="True-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_link</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="True-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>        <span class="k">return</span> <span class="n">t</span>
</span><span id="True-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="True-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>        <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_to_all_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="True-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply f to each element of s.&quot;&quot;&quot;</span>
</span><span id="True-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>    <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="True-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="True-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="True-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>        <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">keep_if_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
</span><span id="True-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list with elements of s for which f(e) is true.&quot;&quot;&quot;</span>
</span><span id="True-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="k">assert</span> <span class="n">is_link</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="True-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="True-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="True-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>        <span class="n">kept</span> <span class="o">=</span> <span class="n">keep_if_link</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</span><span id="True-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>        <span class="k">if</span> <span class="n">f</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
</span><span id="True-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>            <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">kept</span><span class="p">)</span>
</span><span id="True-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>            <span class="k">return</span> <span class="n">kept</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">separator</span><span class="p">):</span>
</span><span id="True-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string of all elements in s separated by separator.&quot;&quot;&quot;</span>
</span><span id="True-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="True-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>    <span class="k">elif</span> <span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">empty</span><span class="p">:</span>
</span><span id="True-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
</span><span id="True-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="True-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">first</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">join_link</span><span class="p">(</span><span class="n">rest</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">separator</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="recursive_construction">Recursive Construction<a class="headerlink" href="#recursive_construction" title="Permanent link">&para;</a></h4>
<p>Linked lists are particularly useful when constructing sequences incrementally, a situation that arises often in recursive computations.
<div class="highlight"><pre><span></span><code><span id="True-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span><span id="True-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a linked list of partitions of n using parts of up to m.</span>
</span><span id="True-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="sd">    Each partition is represented as a linked list.  </span>
</span><span id="True-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="sd">    --&gt; a linked list of linked lists</span>
</span><span id="True-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="True-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>        <span class="k">return</span> <span class="n">link</span><span class="p">(</span><span class="n">empty</span><span class="p">,</span> <span class="n">empty</span><span class="p">)</span> <span class="c1"># A list containing the empty partition</span>
</span><span id="True-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>    <span class="k">elif</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>        <span class="k">return</span> <span class="n">empty</span>
</span><span id="True-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="True-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>        <span class="n">using_m</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="True-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>        <span class="n">with_m</span> <span class="o">=</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">link</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">using_m</span><span class="p">)</span>
</span><span id="True-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>        <span class="n">without_m</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="True-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>        <span class="k">return</span> <span class="n">extend_link</span><span class="p">(</span><span class="n">with_m</span><span class="p">,</span> <span class="n">without_m</span><span class="p">)</span>
</span><span id="True-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>
</span><span id="True-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">print_partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span><span id="True-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>    <span class="n">lists</span> <span class="o">=</span> <span class="n">partitions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span><span id="True-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>    <span class="n">strings</span> <span class="o">=</span> <span class="n">apply_to_all_link</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">join_link</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot; + &quot;</span><span class="p">),</span> <span class="n">lists</span><span class="p">)</span>
</span><span id="True-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">join_link</span><span class="p">(</span><span class="n">strings</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
</span></code></pre></div></p>
<hr />
<h2 id="24_mutable_data">2.4 Mutable Data<a class="headerlink" href="#24_mutable_data" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="the_object_metaphor">The Object Metaphor<a class="headerlink" href="#the_object_metaphor" title="Permanent link">&para;</a></h3>
<p>When we included function values among our data, we acknowledged that data too can have behavior. Functions could be manipulated as data, but could
also be called to perform computation.</p>
<p>Objects combine data values with behavior.
Objects are both information and processes, bundled together to represent the properties, interactions, and behaviors of complex things.</p>
<p>The name date is bound to a class. As we have seen, a class represents a kind of value. Individual dates are called instances of that class. Instances can be constructed by calling the class on
arguments that characterize the instance.
<div class="highlight"><pre><span></span><code><span id="True-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span>
</span><span id="True-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">tues</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</span></code></pre></div>
<strong>attributes</strong>
<div class="highlight"><pre><span></span><code><span id="True-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>&lt;expression&gt; . &lt;name&gt;
</span></code></pre></div>
attribute names are not available in the
general environment</p>
<p>methods, which are function-valued attributes
compute their results from both their arguments and their object
<div class="highlight"><pre><span></span><code><span id="True-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A, %B </span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="True-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="s1">&#39;Tuesday, May 13&#39;</span>
</span></code></pre></div></p>
<p>In fact, all values in Python are objects. That is, all values have behavior and attributes</p>
<h3 id="sequence_objects">Sequence Objects<a class="headerlink" href="#sequence_objects" title="Permanent link">&para;</a></h3>
<h4 id="list">List<a class="headerlink" href="#list" title="Permanent link">&para;</a></h4>
<p>Lists are mutable.
Most changes are performed by invoking methods on list
objects.</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>⚠️distinguish side-effect and return value
<div class="highlight"><pre><span></span><code><span id="True-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</span><span id="True-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</span><span id="True-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
</span><span id="True-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</span></code></pre></div></p>
<p>With mutable data, methods called on one name can affect another name
at the same time.</p>
<p>Lists can be copied using the list constructor function</p>
<h5 id="lists_in_environment_diagrams">lists in environment diagrams<a class="headerlink" href="#lists_in_environment_diagrams" title="Permanent link">&para;</a></h5>
<p>append: 1 more element
<img alt="" src="../append.png" />
extend: the number of the elements in the parameter list
<img alt="" src="../extend.png" />
addition and slice: shallow copy
<img alt="" src="../add_slic.png" />
slice assignment: delete -&gt; insert
<img alt="" src="../slic.png" />
more complex:
<img alt="" src="../more.png" /></p>
<h4 id="sharing_and_identity">Sharing and Identity<a class="headerlink" href="#sharing_and_identity" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span id="True-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">suits</span><span class="p">)</span> 
</span><span id="True-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">suits</span>
</span><span id="True-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">suits</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">)</span> 
</span><span id="True-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">nest</span>
</span><span id="True-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="p">[[</span><span class="s1">&#39;heart&#39;</span><span class="p">,</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;Joker&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">],</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;spade&#39;</span><span class="p">,</span> <span class="s1">&#39;club&#39;</span><span class="p">]</span>
</span></code></pre></div>
<p>Identity: <code>is</code>, <code>is not</code>
Equality: <code>==</code></p>
<p>A <strong>list comprehension</strong> always creates a new list object</p>
<h4 id="tuples">Tuples<a class="headerlink" href="#tuples" title="Permanent link">&para;</a></h4>
<p>immutable sequence</p>
<p>tuple literal: separates element expressions by commas. Parentheses are optional but used commonly in practice.
<div class="highlight"><pre><span></span><code><span id="True-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span>
</span><span id="True-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="True-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="s2">&quot;the&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;and&quot;</span><span class="p">,</span> <span class="s2">&quot;only&quot;</span><span class="p">))</span>
</span><span id="True-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="p">(</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="s1">&#39;only&#39;</span><span class="p">))</span>
</span></code></pre></div>
Empty and one-element tuples
<div class="highlight"><pre><span></span><code><span id="True-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">()</span> <span class="c1"># 0 elements</span>
</span><span id="True-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="p">()</span>
</span><span id="True-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">10</span><span class="p">,)</span> <span class="c1"># 1 element</span>
</span><span id="True-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="p">(</span><span class="mi">10</span><span class="p">,)</span>
</span></code></pre></div></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><div class="highlight"><pre><span></span><code><span id="True-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">code</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="True-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="True-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="mi">8</span>
</span><span id="True-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">code</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="True-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="s1">&#39;down&#39;</span>
</span><span id="True-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">code</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;down&quot;</span><span class="p">)</span>
</span><span id="True-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="mi">2</span>
</span><span id="True-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">code</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</span><span id="True-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="mi">4</span>
</span></code></pre></div>
the methods for manipulating the contents of a list are not available for tuples
but it is possible to change the value of a
mutable element contained within a tuple</p>
<p>Tuples are used implicitly in multiple assignment. An assignment of two values to two names creates
a two-element tuple and then unpacks it.</p>
<h3 id="dictionaries">Dictionaries<a class="headerlink" href="#dictionaries" title="Permanent link">&para;</a></h3>
<p>A dictionary contains <strong>key-value pairs</strong>,  an abstraction for storing and retrieving values that are <em>indexed</em> not by consecutive integers, but by descriptive keys.</p>
<p><em>unordered</em> collections of key-value pairs.
cannot predict what that order will be</p>
<p>iterating <strong>keys</strong>, <strong>values</strong>, and <strong>items</strong> all return iterable values.</p>
<p><code>dict</code> constructor function
<div class="highlight"><pre><span></span><code><span id="True-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">dict</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)])</span>
</span><span id="True-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
</span></code></pre></div></p>
<p>restrictions:
- A key of a dictionary cannot be or contain a mutable value.
    &rarr; Tuples are commonly used for keys in dictionaries because lists cannot be used.
- There can be at most one value for a given key.</p>
<div class="highlight"><pre><span></span><code><span id="True-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="True-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="mi">0</span>
</span><span id="True-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">numerals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="True-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="mi">5</span>
</span></code></pre></div>
<p><strong>dictionary comprehension</strong>
<div class="highlight"><pre><span></span><code><span id="True-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="p">{</span><span class="o">&lt;</span><span class="n">key</span> <span class="n">exp</span><span class="o">&gt;</span> <span class="p">:</span> <span class="o">&lt;</span><span class="n">value</span> <span class="n">exp</span><span class="o">&gt;</span> <span class="k">for</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="nb">iter</span> <span class="n">exp</span><span class="o">&gt;</span> <span class="k">if</span> <span class="o">&lt;</span><span class="nb">filter</span> <span class="n">exp</span><span class="o">&gt;</span><span class="p">}</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)}</span>
</span><span id="True-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">25</span><span class="p">}</span>
</span></code></pre></div></p>
<h3 id="default_mutable_argument">Default Mutable Argument<a class="headerlink" href="#default_mutable_argument" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span id="True-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">s</span> <span class="o">=</span> <span class="p">[]):</span>  <span class="c1"># the same object every time called</span>
</span><span id="True-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>        <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="True-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="True-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">()</span>
</span><span id="True-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="mi">1</span>
</span><span id="True-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span><span class="p">()</span>
</span><span id="True-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="mi">2</span>
</span></code></pre></div>
<h3 id="local_state">Local State<a class="headerlink" href="#local_state" title="Permanent link">&para;</a></h3>
<p>Lists and dictionaries have local state: they are changing values that have some particular contents at any point in the execution of a program.</p>
<p>Functions can also have local state：
<strong>nonlocal statement</strong></p>
<p><div class="highlight"><pre><span></span><code><span id="True-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_withdraw</span><span class="p">(</span><span class="n">balance</span><span class="p">):</span>
</span><span id="True-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a withdraw function that draws down balance with each call.&quot;&quot;&quot;</span>
</span><span id="True-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span><span id="True-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>        <span class="k">nonlocal</span> <span class="n">balance</span>
</span><span id="True-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>        <span class="c1"># Declare the name &quot;balance&quot; nonlocal</span>
</span><span id="True-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>        <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="n">balance</span><span class="p">:</span>
</span><span id="True-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>            <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
</span><span id="True-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>        <span class="n">balance</span> <span class="o">=</span> <span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
</span><span id="True-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>        <span class="c1"># Re-bind the existing balance name</span>
</span><span id="True-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>        <span class="k">return</span> <span class="n">balance</span>
</span><span id="True-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>    <span class="k">return</span> <span class="n">withdraw</span>
</span></code></pre></div>
equivalent as:
<img alt="" src="../nonlocal.png" /></p>
<p>The nonlocal statement declares that whenever we change the binding of the name balance, the binding is changed in the first frame in which balance is already bound.</p>
<p>The nonlocal statement indicates that the name appears somewhere in the environment
other than the first (local) frame or the last (global) frame.</p>
<p>a name outside of the first local frame can be changed by an assignment statement.</p>
<p>The nonlocal statement changes all of the remaining assignment statements in the definition of withdraw.</p>
<p>it will find the first frame
in which balance was already defined and re-bind the name in that frame. If balance has not previously
been bound to a value, then the nonlocal statement will give an error.</p>
<p>By virtue of changing the binding for balance, we have changed the withdraw function as well.</p>
<p>The change to balance from the first call
affects the result of the second call.</p>
<p>both withdraw frames have the same parent. That is, they both extend the environment for make_withdraw. Hence, they share that particular name binding. Calling withdraw has
the side effect of altering the environment that will be extended by future calls to withdraw.</p>
<p>assignment statements: 
- created new bindings 
- re-bound existing names. 
- change the contents of lists and dictionaries.</p>
<p>all instances of a name must refer to the same frame.
<div class="highlight"><pre><span></span><code><span id="True-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">make_withdraw</span><span class="p">(</span><span class="n">balance</span><span class="p">):</span>
</span><span id="True-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span><span id="True-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="n">balance</span><span class="p">:</span>
</span><span id="True-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
</span><span id="True-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="n">balance</span> <span class="o">=</span> <span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
</span><span id="True-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="k">return</span> <span class="n">balance</span>
</span><span id="True-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="k">return</span> <span class="n">withdraw</span>
</span></code></pre></div>
UnboundLocalError: local variable 'balance' referenced before assignment</p>
<h3 id="the_benefits_of_non-local_assignment">The Benefits of Non-Local Assignment<a class="headerlink" href="#the_benefits_of_non-local_assignment" title="Permanent link">&para;</a></h3>
<p>If make_withdraw is called again,
then it will create a separate frame with a separate binding for balance.
<div class="highlight"><pre><span></span><code><span id="True-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="n">wd</span> <span class="o">=</span> <span class="n">make_withdraw</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span><span id="True-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="n">wd2</span> <span class="o">=</span> <span class="n">make_withdraw</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</span><span id="True-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="n">wd2</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</span><span id="True-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="n">wd</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span></code></pre></div>
<img alt="" src="../call_again.png" /></p>
<h3 id="the_cost_of_non-local_assignment">The Cost of Non-Local Assignment<a class="headerlink" href="#the_cost_of_non-local_assignment" title="Permanent link">&para;</a></h3>
<p>An expression that contains only pure function calls is <strong>referentially transparent</strong>; its value does not change if we substitute one of its subexpression with the value of that subexpression.</p>
<p>Re-binding operations violate the conditions of referential transparency because they do more than
return a value; they change the environment.</p>
<h3 id="implementing_lists_and_dictionaries">Implementing Lists and Dictionaries<a class="headerlink" href="#implementing_lists_and_dictionaries" title="Permanent link">&para;</a></h3>
<p>a mutable list could be represented using functions with local state</p>
<p>we cannot use <code>None</code> to represent an empty
mutable list, because two empty lists are not identical values , but <code>None is None</code></p>
<p><strong>Dispatch functions</strong> are effectively many functions in one: the message
determines the behavior of the function, and the additional arguments are used in that behavior.</p>
<p><div class="highlight"><pre><span></span><code><span id="True-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">mutable_link</span><span class="p">():</span>
</span><span id="True-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a functional implementation of a mutable linked list.&quot;&quot;&quot;</span>
</span><span id="True-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>        <span class="n">contents</span> <span class="o">=</span> <span class="n">empty</span>
</span><span id="True-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="True-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>        <span class="k">nonlocal</span> <span class="n">contents</span>
</span><span id="True-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>        <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;len&#39;</span><span class="p">:</span>
</span><span id="True-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>        <span class="k">return</span> <span class="n">len_link</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</span><span id="True-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>        <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;getitem&#39;</span><span class="p">:</span>
</span><span id="True-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>        <span class="k">return</span> <span class="n">getitem_link</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="True-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>        <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;push_first&#39;</span><span class="p">:</span>
</span><span id="True-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>        <span class="n">contents</span> <span class="o">=</span> <span class="n">link</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">contents</span><span class="p">)</span>
</span><span id="True-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>        <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;pop_first&#39;</span><span class="p">:</span>
</span><span id="True-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</span><span id="True-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>        <span class="n">contents</span> <span class="o">=</span> <span class="n">rest</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
</span><span id="True-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>        <span class="k">return</span> <span class="n">f</span>
</span><span id="True-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>        <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
</span><span id="True-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>        <span class="k">return</span> <span class="n">join_link</span><span class="p">(</span><span class="n">contents</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
</span><span id="True-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>        <span class="k">return</span> <span class="n">dispatch</span>
</span><span id="True-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>
</span><span id="True-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">to_mutable_link</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
</span><span id="True-45-21"><a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a functional list with the same contents as source.&quot;&quot;&quot;</span>
</span><span id="True-45-22"><a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>        <span class="n">s</span> <span class="o">=</span> <span class="n">mutable_link</span><span class="p">()</span>
</span><span id="True-45-23"><a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
</span><span id="True-45-24"><a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a>        <span class="n">s</span><span class="p">(</span><span class="s1">&#39;push_first&#39;</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
</span><span id="True-45-25"><a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>        <span class="k">return</span> <span class="n">s</span>
</span><span id="True-45-26"><a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a>
</span><span id="True-45-27"><a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">to_mutable_link</span><span class="p">(</span><span class="n">suits</span><span class="p">)</span>
</span><span id="True-45-28"><a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">))</span>
</span><span id="True-45-29"><a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a><span class="n">heart</span><span class="p">,</span> <span class="n">diamond</span><span class="p">,</span> <span class="n">spade</span><span class="p">,</span> <span class="n">club</span>
</span><span id="True-45-30"><a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">(</span><span class="s1">&#39;pop_first&#39;</span><span class="p">)</span>
</span><span id="True-45-31"><a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a><span class="s1">&#39;heart&#39;</span>
</span><span id="True-45-32"><a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">))</span>
</span><span id="True-45-33"><a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a><span class="n">diamond</span><span class="p">,</span> <span class="n">spade</span><span class="p">,</span> <span class="n">club</span>
</span></code></pre></div>
encapsulates the logic for all operations on a data value within one
function that responds to different messages, is a discipline called message passing</p>
<h4 id="implementing_dictionaries">Implementing Dictionaries<a class="headerlink" href="#implementing_dictionaries" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span id="True-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">dictionary</span><span class="p">():</span>
</span><span id="True-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="sd">&quot;&quot;&quot;Return a functional implementation of a dictionary.&quot;&quot;&quot;</span>
</span><span id="True-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="True-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">getitem</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span><span id="True-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">]</span>
</span><span id="True-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="True-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="True-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="k">return</span> <span class="n">value</span>
</span><span id="True-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="k">def</span><span class="w"> </span><span class="nf">setitem</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="True-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="k">nonlocal</span> <span class="n">records</span>
</span><span id="True-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a><span class="n">non_matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">key</span><span class="p">]</span>
</span><span id="True-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a><span class="err"></span>
</span><span id="True-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a><span class="err"></span>
</span><span id="True-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a><span class="n">records</span> <span class="o">=</span> <span class="n">non_matches</span> <span class="o">+</span> <span class="p">[[</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">]]</span>
</span><span id="True-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">dispatch</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="True-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a><span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;getitem&#39;</span><span class="p">:</span>
</span><span id="True-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a><span class="k">return</span> <span class="n">getitem</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="True-46-18"><a id="__codelineno-46-18" name="__codelineno-46-18" href="#__codelineno-46-18"></a><span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s1">&#39;setitem&#39;</span><span class="p">:</span>
</span><span id="True-46-19"><a id="__codelineno-46-19" name="__codelineno-46-19" href="#__codelineno-46-19"></a><span class="n">setitem</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="True-46-20"><a id="__codelineno-46-20" name="__codelineno-46-20" href="#__codelineno-46-20"></a><span class="k">return</span> <span class="n">dispatch</span>
</span><span id="True-46-21"><a id="__codelineno-46-21" name="__codelineno-46-21" href="#__codelineno-46-21"></a>
</span><span id="True-46-22"><a id="__codelineno-46-22" name="__codelineno-46-22" href="#__codelineno-46-22"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">()</span>
</span><span id="True-46-23"><a id="__codelineno-46-23" name="__codelineno-46-23" href="#__codelineno-46-23"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;setitem&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="True-46-24"><a id="__codelineno-46-24" name="__codelineno-46-24" href="#__codelineno-46-24"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;setitem&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="True-46-25"><a id="__codelineno-46-25" name="__codelineno-46-25" href="#__codelineno-46-25"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;getitem&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="True-46-26"><a id="__codelineno-46-26" name="__codelineno-46-26" href="#__codelineno-46-26"></a><span class="mi">9</span>
</span><span id="True-46-27"><a id="__codelineno-46-27" name="__codelineno-46-27" href="#__codelineno-46-27"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">(</span><span class="s1">&#39;getitem&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</span><span id="True-46-28"><a id="__codelineno-46-28" name="__codelineno-46-28" href="#__codelineno-46-28"></a><span class="mi">16</span>
</span></code></pre></div>
<h3 id="dispatch_dictionaries">Dispatch Dictionaries<a class="headerlink" href="#dispatch_dictionaries" title="Permanent link">&para;</a></h3>
<p>Instead of
using conditionals to implement dispatching, we can use dictionaries with string keys.</p>
<p><div class="highlight"><pre><span></span><code><span id="True-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="mi">1</span>   <span class="k">def</span><span class="w"> </span><span class="nf">account</span><span class="p">(</span><span class="n">initial_balance</span><span class="p">):</span>
</span><span id="True-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="mi">2</span>       <span class="k">def</span><span class="w"> </span><span class="nf">deposit</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span><span id="True-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="mi">3</span>           <span class="n">dispatch</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span>
</span><span id="True-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="mi">4</span>           <span class="k">return</span> <span class="n">dispatch</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]</span>
</span><span id="True-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="mi">5</span>       <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
</span><span id="True-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="mi">6</span>           <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="n">dispatch</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]:</span>
</span><span id="True-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="mi">7</span>               <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
</span><span id="True-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="mi">8</span>           <span class="n">dispatch</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span>
</span><span id="True-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="mi">9</span>           <span class="k">return</span> <span class="n">dispatch</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]</span>
</span><span id="True-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="mi">10</span>      <span class="n">dispatch</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;deposit&#39;</span><span class="p">:</span>   <span class="n">deposit</span><span class="p">,</span>
</span><span id="True-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="mi">11</span>                  <span class="s1">&#39;withdraw&#39;</span><span class="p">:</span>  <span class="n">withdraw</span><span class="p">,</span>
</span><span id="True-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="mi">12</span>                  <span class="s1">&#39;balance&#39;</span><span class="p">:</span>   <span class="n">initial_balance</span><span class="p">}</span>
</span><span id="True-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="mi">13</span>      <span class="k">return</span> <span class="n">dispatch</span>
</span><span id="True-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a><span class="mi">14</span>  
</span><span id="True-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a><span class="mi">15</span>  <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="True-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a><span class="mi">16</span>      <span class="k">return</span> <span class="n">account</span><span class="p">[</span><span class="s1">&#39;withdraw&#39;</span><span class="p">](</span><span class="n">amount</span><span class="p">)</span>
</span><span id="True-47-17"><a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a><span class="mi">17</span>  <span class="k">def</span><span class="w"> </span><span class="nf">deposit</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="True-47-18"><a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a><span class="mi">18</span>      <span class="k">return</span> <span class="n">account</span><span class="p">[</span><span class="s1">&#39;deposit&#39;</span><span class="p">](</span><span class="n">amount</span><span class="p">)</span>
</span><span id="True-47-19"><a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a><span class="mi">19</span>  <span class="k">def</span><span class="w"> </span><span class="nf">check_balance</span><span class="p">(</span><span class="n">account</span><span class="p">):</span>
</span><span id="True-47-20"><a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a><span class="mi">20</span>      <span class="k">return</span> <span class="n">account</span><span class="p">[</span><span class="s1">&#39;balance&#39;</span><span class="p">]</span>
</span><span id="True-47-21"><a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a><span class="mi">21</span>  
</span><span id="True-47-22"><a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a><span class="mi">22</span>  <span class="n">a</span> <span class="o">=</span> <span class="n">account</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span><span id="True-47-23"><a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a><span class="mi">23</span>  <span class="n">deposit</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="True-47-24"><a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a><span class="mi">24</span>  <span class="n">withdraw</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
</span><span id="True-47-25"><a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a><span class="mi">25</span>  <span class="n">check_balance</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></code></pre></div>
<img alt="" src="../dispatch.png" />
By storing the balance in the dispatch dictionary rather than in
the account frame directly, we avoid the need for nonlocal statements in deposit and withdraw.</p>
<h3 id="propagating_constraints">Propagating Constraints<a class="headerlink" href="#propagating_constraints" title="Permanent link">&para;</a></h3>
<p>combine nonlocal assignment, lists, and dictionaries to
build a constraint-based system that supports computation in multiple directions</p>
<p>Expressing
programs as constraints is a type of declarative programming, in which a programmer declares the
structure of a problem to be solved, but abstracts away the details of exactly how the solution to the
problem is computed.</p>
<div class="highlight"><pre><span></span><code><span id="True-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>9 * c = 5 * (f - 32)
</span></code></pre></div>
<h4 id="using_the_constraint_system">Using the Constraint System<a class="headerlink" href="#using_the_constraint_system" title="Permanent link">&para;</a></h4>
<p><img alt="" src="../constrain.png" />
<div class="highlight"><pre><span></span><code><span id="True-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">celsius</span> <span class="o">=</span> <span class="n">connector</span><span class="p">(</span><span class="s1">&#39;Celsius&#39;</span><span class="p">)</span>
</span><span id="True-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fahrenheit</span> <span class="o">=</span> <span class="n">connector</span><span class="p">(</span><span class="s1">&#39;Fahrenheit&#39;</span><span class="p">)</span>
</span><span id="True-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>
</span><span id="True-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">converter</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
</span><span id="True-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="sd">&quot;&quot;&quot;Connect c to f with constraints to convert from Celsius to Fahrenheit.&quot;&quot;&quot;</span>
</span><span id="True-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">connector</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</span><span id="True-49-7"><a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a><span class="n">multiplier</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</span><span id="True-49-8"><a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a><span class="n">multiplier</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
</span><span id="True-49-9"><a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a><span class="n">adder</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="True-49-10"><a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a><span class="n">constant</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span><span id="True-49-11"><a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a><span class="n">constant</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="True-49-12"><a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a><span class="n">constant</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</span><span id="True-49-13"><a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">converter</span><span class="p">(</span><span class="n">celsius</span><span class="p">,</span> <span class="n">fahrenheit</span><span class="p">)</span>
</span><span id="True-49-14"><a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a>
</span><span id="True-49-15"><a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">celsius</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
</span><span id="True-49-16"><a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a><span class="n">Celsius</span> <span class="o">=</span> <span class="mi">25</span>
</span><span id="True-49-17"><a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a><span class="n">Fahrenheit</span> <span class="o">=</span> <span class="mf">77.0</span>
</span><span id="True-49-18"><a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a>
</span><span id="True-49-19"><a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fahrenheit</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="mi">212</span><span class="p">)</span>
</span><span id="True-49-20"><a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a><span class="n">Contradiction</span> <span class="n">detected</span><span class="p">:</span> <span class="mf">77.0</span> <span class="n">vs</span> <span class="mi">212</span>
</span><span id="True-49-21"><a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a>
</span><span id="True-49-22"><a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">celsius</span><span class="p">[</span><span class="s1">&#39;forget&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">)</span>
</span><span id="True-49-23"><a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a><span class="n">Celsius</span> <span class="ow">is</span> <span class="n">forgotten</span>
</span><span id="True-49-24"><a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a><span class="n">Fahrenheit</span> <span class="ow">is</span> <span class="n">forgotten</span>
</span><span id="True-49-25"><a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a>
</span><span id="True-49-26"><a id="__codelineno-49-26" name="__codelineno-49-26" href="#__codelineno-49-26"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fahrenheit</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="mi">212</span><span class="p">)</span>
</span><span id="True-49-27"><a id="__codelineno-49-27" name="__codelineno-49-27" href="#__codelineno-49-27"></a><span class="n">Fahrenheit</span> <span class="o">=</span> <span class="mi">212</span>
</span><span id="True-49-28"><a id="__codelineno-49-28" name="__codelineno-49-28" href="#__codelineno-49-28"></a><span class="n">Celsius</span> <span class="o">=</span> <span class="mf">100.0</span>
</span></code></pre></div></p>
<h4 id="implementing_the_constraint_system">Implementing the Constraint System<a class="headerlink" href="#implementing_the_constraint_system" title="Permanent link">&para;</a></h4>
<p>connector<a href="source, value">'set_val'</a> indicates that the source is requesting the connector to set its
current value to value.
connector<a href="">'has_val'</a> returns whether the connector already has a value.
connector['val'] is the current value of the connector.
connector<a href="source">'forget'</a> tells the connector that the source is requesting it to forget its value.
connector<a href="source">'connect'</a> tells the connector to participate in a new constraint, the source.
Constraints are also dictionaries, which receive information from connectors by means of two
messages:
constraint<a href="">'new_val'</a> indicates that some connector that is connected to the constraint has a
new value.
constraint<a href="">'forget'</a> indicates that some connector that is connected to the constraint has
forgotten its value.</p>
<div class="highlight"><pre><span></span><code><span id="True-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">sub</span>
</span><span id="True-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">adder</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="True-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="sd">&quot;&quot;&quot;The constraint that a + b = c.&quot;&quot;&quot;</span>
</span><span id="True-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="k">return</span> <span class="n">make_ternary_constraint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">sub</span><span class="p">)</span>
</span><span id="True-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>
</span><span id="True-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">make_ternary_constraint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ab</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="n">cb</span><span class="p">):</span>
</span><span id="True-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="sd">&quot;&quot;&quot;The constraint that ab(a,b)=c and ca(c,a)=b and cb(c,b) = a.&quot;&quot;&quot;</span>
</span><span id="True-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">new_value</span><span class="p">():</span>
</span><span id="True-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="n">av</span><span class="p">,</span> <span class="n">bv</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="p">[</span><span class="n">connector</span><span class="p">[</span><span class="s1">&#39;has_val&#39;</span><span class="p">]()</span> <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
</span><span id="True-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="k">if</span> <span class="n">av</span> <span class="ow">and</span> <span class="n">bv</span><span class="p">:</span>
</span><span id="True-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="n">c</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">ab</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
</span><span id="True-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="k">elif</span> <span class="n">av</span> <span class="ow">and</span> <span class="n">cv</span><span class="p">:</span>
</span><span id="True-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="n">b</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">ca</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
</span><span id="True-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="k">elif</span> <span class="n">bv</span> <span class="ow">and</span> <span class="n">cv</span><span class="p">:</span>
</span><span id="True-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="n">a</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">cb</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span>
</span><span id="True-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">forget_value</span><span class="p">():</span>
</span><span id="True-50-17"><a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a><span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="True-50-18"><a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a><span class="n">connector</span><span class="p">[</span><span class="s1">&#39;forget&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">)</span>
</span><span id="True-50-19"><a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a><span class="n">constraint</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;new_val&#39;</span><span class="p">:</span> <span class="n">new_value</span><span class="p">,</span> <span class="s1">&#39;forget&#39;</span><span class="p">:</span> <span class="n">forget_value</span><span class="p">}</span>
</span><span id="True-50-20"><a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a><span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="True-50-21"><a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a><span class="n">connector</span><span class="p">[</span><span class="s1">&#39;connect&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">)</span>
</span><span id="True-50-22"><a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a><span class="k">return</span> <span class="n">constraint</span>
</span><span id="True-50-23"><a id="__codelineno-50-23" name="__codelineno-50-23" href="#__codelineno-50-23"></a>
</span><span id="True-50-24"><a id="__codelineno-50-24" name="__codelineno-50-24" href="#__codelineno-50-24"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">operator</span><span class="w"> </span><span class="kn">import</span> <span class="n">mul</span><span class="p">,</span> <span class="n">truediv</span>
</span><span id="True-50-25"><a id="__codelineno-50-25" name="__codelineno-50-25" href="#__codelineno-50-25"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">multiplier</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="True-50-26"><a id="__codelineno-50-26" name="__codelineno-50-26" href="#__codelineno-50-26"></a><span class="sd">&quot;&quot;&quot;The constraint that a * b = c.&quot;&quot;&quot;</span>
</span><span id="True-50-27"><a id="__codelineno-50-27" name="__codelineno-50-27" href="#__codelineno-50-27"></a><span class="k">return</span> <span class="n">make_ternary_constraint</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">truediv</span><span class="p">,</span> <span class="n">truediv</span><span class="p">)</span>
</span><span id="True-50-28"><a id="__codelineno-50-28" name="__codelineno-50-28" href="#__codelineno-50-28"></a>
</span><span id="True-50-29"><a id="__codelineno-50-29" name="__codelineno-50-29" href="#__codelineno-50-29"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">constant</span><span class="p">(</span><span class="n">connector</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="True-50-30"><a id="__codelineno-50-30" name="__codelineno-50-30" href="#__codelineno-50-30"></a><span class="sd">&quot;&quot;&quot;The constraint that connector = value.&quot;&quot;&quot;</span>
</span><span id="True-50-31"><a id="__codelineno-50-31" name="__codelineno-50-31" href="#__codelineno-50-31"></a><span class="n">constraint</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="True-50-32"><a id="__codelineno-50-32" name="__codelineno-50-32" href="#__codelineno-50-32"></a><span class="n">connector</span><span class="p">[</span><span class="s1">&#39;set_val&#39;</span><span class="p">](</span><span class="n">constraint</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="True-50-33"><a id="__codelineno-50-33" name="__codelineno-50-33" href="#__codelineno-50-33"></a><span class="k">return</span> <span class="n">constraint</span>
</span><span id="True-50-34"><a id="__codelineno-50-34" name="__codelineno-50-34" href="#__codelineno-50-34"></a>
</span><span id="True-50-35"><a id="__codelineno-50-35" name="__codelineno-50-35" href="#__codelineno-50-35"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">connector</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="True-50-36"><a id="__codelineno-50-36" name="__codelineno-50-36" href="#__codelineno-50-36"></a><span class="sd">&quot;&quot;&quot;A connector between constraints.&quot;&quot;&quot;</span>
</span><span id="True-50-37"><a id="__codelineno-50-37" name="__codelineno-50-37" href="#__codelineno-50-37"></a><span class="n">informant</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="True-50-38"><a id="__codelineno-50-38" name="__codelineno-50-38" href="#__codelineno-50-38"></a><span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="True-50-39"><a id="__codelineno-50-39" name="__codelineno-50-39" href="#__codelineno-50-39"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_value</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="True-50-40"><a id="__codelineno-50-40" name="__codelineno-50-40" href="#__codelineno-50-40"></a><span class="k">nonlocal</span> <span class="n">informant</span>
</span><span id="True-50-41"><a id="__codelineno-50-41" name="__codelineno-50-41" href="#__codelineno-50-41"></a><span class="n">val</span> <span class="o">=</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span>
</span><span id="True-50-42"><a id="__codelineno-50-42" name="__codelineno-50-42" href="#__codelineno-50-42"></a><span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="True-50-43"><a id="__codelineno-50-43" name="__codelineno-50-43" href="#__codelineno-50-43"></a><span class="n">informant</span><span class="p">,</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">,</span> <span class="n">value</span>
</span><span id="True-50-44"><a id="__codelineno-50-44" name="__codelineno-50-44" href="#__codelineno-50-44"></a><span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="True-50-45"><a id="__codelineno-50-45" name="__codelineno-50-45" href="#__codelineno-50-45"></a><span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="True-50-46"><a id="__codelineno-50-46" name="__codelineno-50-46" href="#__codelineno-50-46"></a><span class="n">inform_all_except</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;new_val&#39;</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
</span><span id="True-50-47"><a id="__codelineno-50-47" name="__codelineno-50-47" href="#__codelineno-50-47"></a><span class="k">else</span><span class="p">:</span>
</span><span id="True-50-48"><a id="__codelineno-50-48" name="__codelineno-50-48" href="#__codelineno-50-48"></a><span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="n">value</span><span class="p">:</span>
</span><span id="True-50-49"><a id="__codelineno-50-49" name="__codelineno-50-49" href="#__codelineno-50-49"></a><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Contradiction detected:&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="s1">&#39;vs&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="True-50-50"><a id="__codelineno-50-50" name="__codelineno-50-50" href="#__codelineno-50-50"></a><span class="k">def</span><span class="w"> </span><span class="nf">forget_value</span><span class="p">(</span><span class="n">source</span><span class="p">):</span>
</span><span id="True-50-51"><a id="__codelineno-50-51" name="__codelineno-50-51" href="#__codelineno-50-51"></a><span class="k">nonlocal</span> <span class="n">informant</span>
</span><span id="True-50-52"><a id="__codelineno-50-52" name="__codelineno-50-52" href="#__codelineno-50-52"></a><span class="k">if</span> <span class="n">informant</span> <span class="o">==</span> <span class="n">source</span><span class="p">:</span>
</span><span id="True-50-53"><a id="__codelineno-50-53" name="__codelineno-50-53" href="#__codelineno-50-53"></a><span class="n">informant</span><span class="p">,</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="True-50-54"><a id="__codelineno-50-54" name="__codelineno-50-54" href="#__codelineno-50-54"></a><span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="True-50-55"><a id="__codelineno-50-55" name="__codelineno-50-55" href="#__codelineno-50-55"></a><span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;is forgotten&#39;</span><span class="p">)</span>
</span><span id="True-50-56"><a id="__codelineno-50-56" name="__codelineno-50-56" href="#__codelineno-50-56"></a><span class="n">inform_all_except</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;forget&#39;</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
</span><span id="True-50-57"><a id="__codelineno-50-57" name="__codelineno-50-57" href="#__codelineno-50-57"></a><span class="n">connector</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="True-50-58"><a id="__codelineno-50-58" name="__codelineno-50-58" href="#__codelineno-50-58"></a><span class="s1">&#39;set_val&#39;</span><span class="p">:</span> <span class="n">set_value</span><span class="p">,</span>
</span><span id="True-50-59"><a id="__codelineno-50-59" name="__codelineno-50-59" href="#__codelineno-50-59"></a><span class="s1">&#39;forget&#39;</span><span class="p">:</span> <span class="n">forget_value</span><span class="p">,</span>
</span><span id="True-50-60"><a id="__codelineno-50-60" name="__codelineno-50-60" href="#__codelineno-50-60"></a><span class="s1">&#39;has_val&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">connector</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="True-50-61"><a id="__codelineno-50-61" name="__codelineno-50-61" href="#__codelineno-50-61"></a><span class="s1">&#39;connect&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">source</span><span class="p">:</span> <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)}</span>
</span><span id="True-50-62"><a id="__codelineno-50-62" name="__codelineno-50-62" href="#__codelineno-50-62"></a><span class="k">return</span> <span class="n">connector</span>
</span><span id="True-50-63"><a id="__codelineno-50-63" name="__codelineno-50-63" href="#__codelineno-50-63"></a>
</span><span id="True-50-64"><a id="__codelineno-50-64" name="__codelineno-50-64" href="#__codelineno-50-64"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span><span class="w"> </span><span class="nf">inform_all_except</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">constraints</span><span class="p">):</span>
</span><span id="True-50-65"><a id="__codelineno-50-65" name="__codelineno-50-65" href="#__codelineno-50-65"></a><span class="sd">&quot;&quot;&quot;Inform all constraints of the message, except source.&quot;&quot;&quot;</span>
</span><span id="True-50-66"><a id="__codelineno-50-66" name="__codelineno-50-66" href="#__codelineno-50-66"></a><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">:</span>
</span><span id="True-50-67"><a id="__codelineno-50-67" name="__codelineno-50-67" href="#__codelineno-50-67"></a><span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="n">source</span><span class="p">:</span>
</span><span id="True-50-68"><a id="__codelineno-50-68" name="__codelineno-50-68" href="#__codelineno-50-68"></a><span class="n">c</span><span class="p">[</span><span class="n">message</span><span class="p">]()</span>
</span></code></pre></div>
<p>The dictionary called constraint / connector is a dispatch dictionary, but also the constraint object itself. It
responds to the two messages that constraints receive, but is also passed as the source argument in
calls to its connectors.</p>
<p>forget-value, which first checks to
make sure that the request is coming from the same constraint that set the value originally</p>
<hr />
<h2 id="25_object-oriented_programming">2.5 Object-Oriented Programming<a class="headerlink" href="#25_object-oriented_programming" title="Permanent link">&para;</a></h2>
<hr />
<p>Like the functions in data abstraction, classes create
abstraction barriers between the use and implementation of data</p>
<h3 id="objects_and_classes">Objects and Classes<a class="headerlink" href="#objects_and_classes" title="Permanent link">&para;</a></h3>
<ul>
<li>Class: template </li>
<li>Object: instance </li>
</ul>
<p>An attribute of an object is a name-value pair associated with the object, which is accessible via dot notation</p>
<p>The attributes specific to a particular object, as opposed to all objects of a class, are called
<strong>instance attributes</strong> / <strong>fields</strong> / <strong>properties</strong> / <strong>instance variables</strong></p>
<p>Functions that operate on the object or perform object-specific computations are called <strong>methods</strong></p>
<p>The
return values and side effects of a method can depend upon and change other attributes of the
object</p>
<p>methods are invoked on a particular object</p>
<h3 id="defining_classes">Defining Classes<a class="headerlink" href="#defining_classes" title="Permanent link">&para;</a></h3>
<p>Class names are conventionally written using the <strong>CapWords convention / CamelCase</strong></p>
<p>The method that <strong>initializes</strong> objects, <code>__init__</code> , is called the <strong>constructor</strong> for the class.
<div class="highlight"><pre><span></span><code><span id="True-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Account</span><span class="p">:</span>
</span><span id="True-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
</span><span id="True-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="True-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
</span><span id="True-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="True-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+</span> <span class="n">amount</span>
</span><span id="True-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
</span><span id="True-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="True-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>        <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="p">:</span>
</span><span id="True-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a>        <span class="k">return</span> <span class="s1">&#39;Insufficient funds&#39;</span>
</span><span id="True-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-</span> <span class="n">amount</span>
</span><span id="True-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span>
</span></code></pre></div>
New objects that have user-defined classes are only created when a class is <strong>instantiated</strong> with call expression syntax.</p>
<p><strong>Object identity</strong> is compared using the <code>is</code> and <code>is not</code> operators.</p>
<h3 id="message_passing_and_dot_expressions">Message Passing and Dot Expressions<a class="headerlink" href="#message_passing_and_dot_expressions" title="Permanent link">&para;</a></h3>
<p>Objects take messages using dot notation, but instead of those messages being arbitrary
string-valued keys, they are names local to a class.</p>
<p>named local state values (the
instance attributes)</p>
<p>state can be accessed and manipulated using dot notation, without
having to employ nonlocal statements</p>
<p><strong>Dot expressions</strong>
<div class="highlight"><pre><span></span><code><span id="True-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>&lt;expression&gt; . &lt;name&gt;
</span></code></pre></div>
built-in function <code>getattr</code> also returns an attribute for an object by name
<div class="highlight"><pre><span></span><code><span id="True-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="nb">getattr</span><span class="p">(</span><span class="n">spock_account</span><span class="p">,</span> <span class="s1">&#39;balance&#39;</span><span class="p">)</span>
</span></code></pre></div></p>
<p><strong>Methods and functions</strong>
- as an attribute of a class, a method is just a <strong>function</strong>
- as an attribute of an instance, it is a <strong>bound method</strong>: 
  couple together a function and the object on which that method will be invoked
<div class="highlight"><pre><span></span><code><span id="True-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">)</span>
</span><span id="True-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">function</span><span class="s1">&#39;&gt;</span>
</span><span id="True-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">spock_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">)</span>
</span><span id="True-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">method</span><span class="s1">&#39;&gt;</span>
</span></code></pre></div></p>
<div class="highlight"><pre><span></span><code><span id="True-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">spock_account</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span> <span class="c1"># as function</span>
</span><span id="True-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="c1"># The deposit function takes 2 arguments</span>
</span><span id="True-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="mi">1011</span>
</span><span id="True-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">spock_account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># as bound method</span>
</span><span id="True-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="c1"># The deposit method takes 1 argument</span>
</span><span id="True-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="mi">2011</span>
</span></code></pre></div>
<h3 id="class_attributes_class_variables_static_variables">Class Attributes / Class Variables / Static Variables<a class="headerlink" href="#class_attributes_class_variables_static_variables" title="Permanent link">&para;</a></h3>
<p>Some attribute values are shared across all objects of a given class
<div class="highlight"><pre><span></span><code><span id="True-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Account</span><span class="p">:</span>
</span><span id="True-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>    <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.02</span>
</span><span id="True-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="c1"># A class attribute</span>
</span><span id="True-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
</span><span id="True-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="True-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
</span></code></pre></div>
can still be accessed from any instance of the class.
a single assignment statement to a class attribute changes the value of the attribute for all
instances of the class.</p>
<p><strong>Attribute names</strong>
<div class="highlight"><pre><span></span><code><span id="True-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span> <span class="o">.</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</span></code></pre></div>
To evaluate a dot expression:
1. <code>&lt;expression&gt;</code>: yields the object
2. <code>&lt;name&gt;</code>:
- instance: look up instance attribute -&gt; class attribute
- class: look up class attribute</p>
<p><strong>Attribute assignment</strong>
- If the object is an instance, then assignment sets an instance attribute. 
- If the object is a class, then assignment sets a class attribute. </p>
<p>As a consequence, <em>assignment to an attribute of an object cannot affect the attributes of its class</em></p>
<p>If we assign to the named attribute <code>interest</code> of an account instance, we create a new instance attribute that <em>has the same name</em> as the existing class attribute.</p>
<h3 id="inheritance">Inheritance<a class="headerlink" href="#inheritance" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>base class</strong> / <strong>parent class</strong> / <strong>superclass</strong></li>
<li><strong>subclass</strong> / <strong>child class</strong> </li>
</ul>
<p>A subclass <strong>inherits</strong> the attributes of its base class, but may <strong>override</strong> certain attributes. </p>
<p>object metaphor:
- Inheritance: <code>is-a</code> relationships between classes
- Composition(attribute): <code>has-a</code> relationships
  eg. Bank &amp; Account</p>
<h3 id="using_inheritance">Using Inheritance<a class="headerlink" href="#using_inheritance" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span id="True-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">CheckingAccount</span><span class="p">(</span><span class="n">Account</span><span class="p">):</span>
</span><span id="True-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A bank account that charges for withdrawals.&quot;&quot;&quot;</span>
</span><span id="True-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>    <span class="n">withdraw_charge</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1"># introduce a class attribute that is specific to the CheckingAccount class</span>
</span><span id="True-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>    <span class="n">interest</span> <span class="o">=</span> <span class="mf">0.01</span>         <span class="c1"># override</span>
</span><span id="True-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>     <span class="c1"># override</span>
</span><span id="True-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>        <span class="k">return</span> <span class="n">Account</span><span class="o">.</span><span class="n">withdraw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">withdraw_charge</span><span class="p">)</span>    <span class="c1"># call ancestor</span>
</span></code></pre></div>
<p>name binding:
- instance: instance attribute -&gt; class attribute -&gt; base class attribute
- class: class attribute -&gt; base class attribute</p>
<p><strong>Calling ancestors</strong>: Attributes that have been overridden are still accessible via class objects.</p>
<p>Notice that we called <code>self.withdraw_charge</code> rather than the equivalent <code>CheckingAccount.withdraw_charge</code>.
benefit: a class that inherits from CheckingAccount might override the withdrawal charge. If that is the case, we would like our implementation of withdraw to find that new value instead of the old one.</p>
<p>An <strong>object interface</strong> is a collection of attributes and conditions on those attributes
The classes <code>Account</code> and <code>CheckingAccount</code> both implement this interface. Inheritance specifically promotes <strong>name sharing</strong> in this way</p>
<p>Do not make assumptions about object types
<div class="highlight"><pre><span></span><code><span id="True-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">deposit_all</span><span class="p">(</span><span class="n">winners</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="True-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>    <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">winners</span><span class="p">:</span>
</span><span id="True-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a>        <span class="n">account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
</span></code></pre></div>
Assuming a particular class of account would violate the <strong>abstraction barrier</strong> of the account <strong>object abstraction</strong>
<div class="highlight"><pre><span></span><code><span id="True-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">deposit_all</span><span class="p">(</span><span class="n">winners</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
</span><span id="True-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>    <span class="k">for</span> <span class="n">account</span> <span class="ow">in</span> <span class="n">winners</span><span class="p">:</span>
</span><span id="True-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>        <span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">amount</span><span class="p">)</span>
</span></code></pre></div>
more complex example:
<img alt="" src="../inheritance.png" />
when a C instance is created, the <code>f</code> function in <code>__init__</code> is in class C instead of A!</p>
<h3 id="multiple_inheritance">Multiple Inheritance<a class="headerlink" href="#multiple_inheritance" title="Permanent link">&para;</a></h3>
<p>a subclass may inherit attributes from multiple base classes</p>
<p><div class="highlight"><pre><span></span><code><span id="True-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">SavingsAccount</span><span class="p">(</span><span class="n">Account</span><span class="p">):</span>
</span><span id="True-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="n">deposit_charge</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="True-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
</span><span id="True-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="k">return</span> <span class="n">Account</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amount</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">deposit_charge</span><span class="p">)</span>
</span></code></pre></div>
<div class="highlight"><pre><span></span><code><span id="True-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AsSeenOnTVAccount</span><span class="p">(</span><span class="n">CheckingAccount</span><span class="p">,</span> <span class="n">SavingsAccount</span><span class="p">):</span>
</span><span id="True-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">account_holder</span><span class="p">):</span>
</span><span id="True-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="bp">self</span><span class="o">.</span><span class="n">holder</span> <span class="o">=</span> <span class="n">account_holder</span>
</span><span id="True-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="mi">1</span>
</span></code></pre></div>
<img alt="" src="../inherit.png" />
Python resolves names from left to right, then upwards</p>
<h3 id="the_role_of_objects">The Role of Objects<a class="headerlink" href="#the_role_of_objects" title="Permanent link">&para;</a></h3>
<p>Object-oriented programming is particularly well-suited to programs that model systems that have <em>separate but interacting</em> parts.</p>
<p>On the other hand, classes may not provide the best mechanism for implementing certain abstractions. 
Functional abstractions provide a more natural metaphor for representing relationships between inputs and outputs, which can also enforce a separation of concerns.</p>
<hr />
<h2 id="26_implementing_classes_and_objects">2.6 Implementing Classes and Objects<a class="headerlink" href="#26_implementing_classes_and_objects" title="Permanent link">&para;</a></h2>
<hr />
<hr />
<h2 id="27_object_abstraction">2.7 Object Abstraction<a class="headerlink" href="#27_object_abstraction" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="string_conversion">String Conversion<a class="headerlink" href="#string_conversion" title="Permanent link">&para;</a></h3>
<p>all objects should produce two different string representations
- <code>str</code>: human-interpretable text<br />
- <code>repr</code>: Python-interpretable expression
    The result is what Python prints in an interactive session.
<div class="highlight"><pre><span></span><code><span id="True-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span>
</span><span id="True-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span><span id="True-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">repr</span><span class="p">(</span><span class="n">tues</span><span class="p">)</span>
</span><span id="True-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="s1">&#39;datetime.date(2011, 9, 12)&#39;</span>
</span><span id="True-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="p">(</span><span class="n">tues</span><span class="p">)</span>   <span class="c1"># or print(tues)</span>
</span><span id="True-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="s1">&#39;2011-09-12&#39;</span>
</span></code></pre></div></p>
<p><strong>generic / polymorphic function</strong> can be applied to many (poly) different forms (morph) of data.</p>
<p>ne way to create such a function:
use a shared attribute name with a different definition in each class.</p>
<p>solution in this case: the <code>repr</code> function always invokes a method called <code>__repr__</code> on its argument. 
The str constructor is implemented in a similar manner
<div class="highlight"><pre><span></span><code><span id="True-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</span><span id="True-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="s1">&#39;datetime.date(2011, 9, 12)&#39;</span>
</span><span id="True-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">tues</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="True-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="s1">&#39;2011-09-12&#39;</span>
</span></code></pre></div></p>
<h3 id="string_interpolation">String Interpolation<a class="headerlink" href="#string_interpolation" title="Permanent link">&para;</a></h3>
<p>sub-exprssions are evaluated in the current environment 
the result contains the <code>str</code> string of the value of the sub-expressions</p>
<h3 id="special_methods">Special Methods<a class="headerlink" href="#special_methods" title="Permanent link">&para;</a></h3>
<p>certain special names are invoked by the Python interpreter in special circumstances</p>
<h4 id="true_and_false_values">True and false values<a class="headerlink" href="#true_and_false_values" title="Permanent link">&para;</a></h4>
<p>By default, objects of user-defined classes are considered to be true, but the special
<code>__bool__</code> method can be used to override this behavior
<div class="highlight"><pre><span></span><code><span id="True-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">Account</span><span class="o">.</span><span class="fm">__bool__</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">!=</span> <span class="mi">0</span>
</span></code></pre></div></p>
<h4 id="sequence_operations">Sequence operations<a class="headerlink" href="#sequence_operations" title="Permanent link">&para;</a></h4>
<p>The len function invokes the <code>__len__</code> method
<div class="highlight"><pre><span></span><code><span id="True-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Go Bears!&#39;</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span>
</span><span id="True-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="mi">9</span>
</span></code></pre></div>
Python uses a sequence's length to determine its truth value, if it does not provide a <code>__bool__</code> method. Empty sequences are false, while non-empty sequences are true.</p>
<p>The <code>__getitem__</code> method is invoked by the element selection operator
<div class="highlight"><pre><span></span><code><span id="True-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Go Bears!&#39;</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="True-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="s1">&#39;B&#39;</span>
</span></code></pre></div></p>
<h4 id="callable_objects">Callable objects<a class="headerlink" href="#callable_objects" title="Permanent link">&para;</a></h4>
<p>With <code>__call__</code> method, we can define a class that behaves like a higher-order function.
<div class="highlight"><pre><span></span><code><span id="True-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span><span class="w"> </span><span class="nc">Adder</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="True-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="True-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="True-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="True-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="n">k</span>
</span><span id="True-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">add_three_obj</span> <span class="o">=</span> <span class="n">Adder</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="True-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">add_three_obj</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</span><span id="True-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="mi">7</span>
</span></code></pre></div></p>
<h4 id="arithmetic">Arithmetic<a class="headerlink" href="#arithmetic" title="Permanent link">&para;</a></h4>
<p>to evaluate expressions that contain the + operator
1. checks for an <code>__add__</code> method on the value of the left operand, then checks for an <code>__radd__</code> method on the value of the right operand. 
2. If either is found, that method is invoked with the value of the other operand as its argument.</p>
<h3 id="multiple_representations">Multiple Representations<a class="headerlink" href="#multiple_representations" title="Permanent link">&para;</a></h3>
<p>In addition to the data-abstraction barriers that isolate representation from use, we need <em>abstraction barriers</em> that isolate different <em>design choices</em> from each other and permit different choices to <em>coexist</em> in a single program.</p>
<blockquote>
<p>complex 
- ComplexRI constructs a complex number from real and imaginary parts.
- ComplexMA constructs a complex number from a magnitude and angle.</p>
</blockquote>
<p>An <strong>interface</strong> is a set of shared attribute names, along with a specification of their behavior</p>
<p>these attributes must be <strong>consistent</strong></p>
<p>The Complex class implicitly defines this interface by determining how these
attributes are used to add and mul complex numbers.</p>
<p>Python has a simple feature for <em>computing attributes on the fly</em> from zero-argument functions. The
<code>@property</code> decorator allows functions to be called without call expression syntax</p>
<div class="highlight"><pre><span></span><code><span id="True-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">atan2</span>
</span><span id="True-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span><span class="w"> </span><span class="nc">ComplexRI</span><span class="p">(</span><span class="n">Complex</span><span class="p">):</span>
</span><span id="True-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">real</span><span class="p">,</span> <span class="n">imag</span><span class="p">):</span>
</span><span id="True-69-4"><a id="__codelineno-69-4" name="__codelineno-69-4" href="#__codelineno-69-4"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="n">real</span>
</span><span id="True-69-5"><a id="__codelineno-69-5" name="__codelineno-69-5" href="#__codelineno-69-5"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">imag</span> <span class="o">=</span> <span class="n">imag</span>
</span><span id="True-69-6"><a id="__codelineno-69-6" name="__codelineno-69-6" href="#__codelineno-69-6"></a>        <span class="nd">@property</span>
</span><span id="True-69-7"><a id="__codelineno-69-7" name="__codelineno-69-7" href="#__codelineno-69-7"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-69-8"><a id="__codelineno-69-8" name="__codelineno-69-8" href="#__codelineno-69-8"></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span id="True-69-9"><a id="__codelineno-69-9" name="__codelineno-69-9" href="#__codelineno-69-9"></a>        <span class="nd">@property</span>
</span><span id="True-69-10"><a id="__codelineno-69-10" name="__codelineno-69-10" href="#__codelineno-69-10"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-69-11"><a id="__codelineno-69-11" name="__codelineno-69-11" href="#__codelineno-69-11"></a>            <span class="k">return</span> <span class="n">atan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
</span><span id="True-69-12"><a id="__codelineno-69-12" name="__codelineno-69-12" href="#__codelineno-69-12"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-69-13"><a id="__codelineno-69-13" name="__codelineno-69-13" href="#__codelineno-69-13"></a>            <span class="k">return</span> <span class="s1">&#39;ComplexRI(</span><span class="si">{0:g}</span><span class="s1">, </span><span class="si">{1:g}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="generic_functions">Generic Functions<a class="headerlink" href="#generic_functions" title="Permanent link">&para;</a></h3>
<p>implement generic functions
- interfaces and message passing
- type dispatching
- type coercion</p>
<div class="highlight"><pre><span></span><code><span id="True-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">fractions</span><span class="w"> </span><span class="kn">import</span> <span class="n">gcd</span>
</span><span id="True-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span><span class="w"> </span><span class="nc">Rational</span><span class="p">(</span><span class="n">Number</span><span class="p">):</span>
</span><span id="True-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">):</span>
</span><span id="True-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a>            <span class="n">g</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
</span><span id="True-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">numer</span> <span class="o">=</span> <span class="n">numer</span> <span class="o">//</span> <span class="n">g</span>
</span><span id="True-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">denom</span> <span class="o">=</span> <span class="n">denom</span> <span class="o">//</span> <span class="n">g</span>
</span><span id="True-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a>        <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a>            <span class="k">return</span> <span class="s1">&#39;Rational(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denom</span><span class="p">)</span>
</span><span id="True-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10" href="#__codelineno-70-10"></a>            <span class="n">nx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">denom</span>
</span><span id="True-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11" href="#__codelineno-70-11"></a>            <span class="n">ny</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">numer</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">denom</span>
</span><span id="True-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12" href="#__codelineno-70-12"></a>            <span class="k">return</span> <span class="n">Rational</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">ny</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span>
</span><span id="True-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13" href="#__codelineno-70-13"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">mul</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-70-14"><a id="__codelineno-70-14" name="__codelineno-70-14" href="#__codelineno-70-14"></a>            <span class="n">numer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numer</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">numer</span>
</span><span id="True-70-15"><a id="__codelineno-70-15" name="__codelineno-70-15" href="#__codelineno-70-15"></a>            <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denom</span> <span class="o">*</span> <span class="n">other</span><span class="o">.</span><span class="n">denom</span>
</span><span id="True-70-16"><a id="__codelineno-70-16" name="__codelineno-70-16" href="#__codelineno-70-16"></a>            <span class="k">return</span> <span class="n">Rational</span><span class="p">(</span><span class="n">numer</span><span class="p">,</span> <span class="n">denom</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="type_dispatching">type dispatching<a class="headerlink" href="#type_dispatching" title="Permanent link">&para;</a></h4>
<ul>
<li>built-in function <code>isinstance</code></li>
<li>user-defined function
<div class="highlight"><pre><span></span><code><span id="True-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_real</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
</span><span id="True-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return whether c is a real number with no imaginary part.&quot;&quot;&quot;</span>
</span><span id="True-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ComplexRI</span><span class="p">):</span>
</span><span id="True-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a>        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="True-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ComplexMA</span><span class="p">):</span>
</span><span id="True-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a>        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">angle</span> <span class="o">%</span> <span class="n">pi</span> <span class="o">==</span> <span class="mi">0</span>
</span></code></pre></div></li>
<li>give a type_tag attribute</li>
</ul>
<div class="highlight"><pre><span></span><code><span id="True-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Number</span><span class="p">:</span>
</span><span id="True-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">:</span>
</span><span id="True-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="True-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a>        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adders</span><span class="p">:</span>
</span><span id="True-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">adders</span><span class="p">)</span>
</span><span id="True-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">:</span>
</span><span id="True-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="True-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a>        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">multipliers</span><span class="p">:</span>
</span><span id="True-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">multipliers</span><span class="p">)</span>
</span><span id="True-72-12"><a id="__codelineno-72-12" name="__codelineno-72-12" href="#__codelineno-72-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">cross_apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">cross_fns</span><span class="p">):</span>
</span><span id="True-72-13"><a id="__codelineno-72-13" name="__codelineno-72-13" href="#__codelineno-72-13"></a>        <span class="n">cross_fn</span> <span class="o">=</span> <span class="n">cross_fns</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)]</span>
</span><span id="True-72-14"><a id="__codelineno-72-14" name="__codelineno-72-14" href="#__codelineno-72-14"></a>        <span class="k">return</span> <span class="n">cross_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="True-72-15"><a id="__codelineno-72-15" name="__codelineno-72-15" href="#__codelineno-72-15"></a>    <span class="n">adders</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;com&quot;</span><span class="p">,</span> <span class="s2">&quot;rat&quot;</span><span class="p">):</span> <span class="n">add_complex_and_rational</span><span class="p">,</span>
</span><span id="True-72-16"><a id="__codelineno-72-16" name="__codelineno-72-16" href="#__codelineno-72-16"></a>    <span class="p">(</span><span class="s2">&quot;rat&quot;</span><span class="p">,</span> <span class="s2">&quot;com&quot;</span><span class="p">):</span> <span class="n">add_rational_and_complex</span><span class="p">}</span>
</span><span id="True-72-17"><a id="__codelineno-72-17" name="__codelineno-72-17" href="#__codelineno-72-17"></a>    <span class="n">multipliers</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;com&quot;</span><span class="p">,</span> <span class="s2">&quot;rat&quot;</span><span class="p">):</span> <span class="n">mul_complex_and_rational</span><span class="p">,</span>
</span><span id="True-72-18"><a id="__codelineno-72-18" name="__codelineno-72-18" href="#__codelineno-72-18"></a>    <span class="p">(</span><span class="s2">&quot;rat&quot;</span><span class="p">,</span> <span class="s2">&quot;com&quot;</span><span class="p">):</span> <span class="n">mul_rational_and_complex</span><span class="p">}</span>
</span></code></pre></div>
<h4 id="type_coercion">type coercion<a class="headerlink" href="#type_coercion" title="Permanent link">&para;</a></h4>
<p>Often the different data types are not completely
independent, and there may be ways by which objects of one type may be viewed as being of
another type. This process is called <strong>coercion</strong></p>
<div class="highlight"><pre><span></span><code><span id="True-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Number</span><span class="p">:</span>
</span><span id="True-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="True-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a>        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="True-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="True-73-7"><a id="__codelineno-73-7" name="__codelineno-73-7" href="#__codelineno-73-7"></a>        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="True-73-8"><a id="__codelineno-73-8" name="__codelineno-73-8" href="#__codelineno-73-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coerce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="True-73-9"><a id="__codelineno-73-9" name="__codelineno-73-9" href="#__codelineno-73-9"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">:</span>
</span><span id="True-73-10"><a id="__codelineno-73-10" name="__codelineno-73-10" href="#__codelineno-73-10"></a>            <span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span>
</span><span id="True-73-11"><a id="__codelineno-73-11" name="__codelineno-73-11" href="#__codelineno-73-11"></a>        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coercions</span><span class="p">:</span>
</span><span id="True-73-12"><a id="__codelineno-73-12" name="__codelineno-73-12" href="#__codelineno-73-12"></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coerce_to</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">),</span> <span class="n">other</span><span class="p">)</span>
</span><span id="True-73-13"><a id="__codelineno-73-13" name="__codelineno-73-13" href="#__codelineno-73-13"></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coercions</span><span class="p">:</span>
</span><span id="True-73-14"><a id="__codelineno-73-14" name="__codelineno-73-14" href="#__codelineno-73-14"></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">coerce_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">))</span>
</span><span id="True-73-15"><a id="__codelineno-73-15" name="__codelineno-73-15" href="#__codelineno-73-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coerce_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_tag</span><span class="p">):</span>
</span><span id="True-73-16"><a id="__codelineno-73-16" name="__codelineno-73-16" href="#__codelineno-73-16"></a>        <span class="n">coercion_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coercions</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_tag</span><span class="p">,</span> <span class="n">other_tag</span><span class="p">)]</span>
</span><span id="True-73-17"><a id="__codelineno-73-17" name="__codelineno-73-17" href="#__codelineno-73-17"></a>        <span class="k">return</span> <span class="n">coercion_fn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="True-73-18"><a id="__codelineno-73-18" name="__codelineno-73-18" href="#__codelineno-73-18"></a>    <span class="n">coercions</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;rat&#39;</span><span class="p">,</span> <span class="s1">&#39;com&#39;</span><span class="p">):</span> <span class="n">rational_to_complex</span><span class="p">}</span>
</span></code></pre></div>
<p>may try to coerce two different types each into <em>a third common type</em>
eg. a rhombus and a rectangle: neither is a special case of the other, but both can be viewed as quadrilaterals</p>
<p>drawbacks. <em>lose information</em></p>
<hr />
<h2 id="28_efficiency">2.8 Efficiency<a class="headerlink" href="#28_efficiency" title="Permanent link">&para;</a></h2>
<hr />
<p><img alt="" src="../fib.png" /></p>
<p><strong>Space</strong>
An environment is <strong>active</strong> if it provides the evaluation context for some expression being evaluated. 
An environment becomes <strong>inactive</strong> whenever the function call <em>for which its first frame was created</em> finally <em>returns</em>.</p>
<p>In general, the space required for tree-recursive functions will be proportional to the <em>maximum depth of the tree.</em></p>
<hr />
<h2 id="29_recursive_objects">2.9 Recursive Objects<a class="headerlink" href="#29_recursive_objects" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="link_class">Link Class<a class="headerlink" href="#link_class" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span id="True-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Link</span><span class="p">:</span>
</span><span id="True-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A linked list is either a Link object or Link.empty</span>
</span><span id="True-74-3"><a id="__codelineno-74-3" name="__codelineno-74-3" href="#__codelineno-74-3"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="True-74-4"><a id="__codelineno-74-4" name="__codelineno-74-4" href="#__codelineno-74-4"></a>    <span class="n">empty</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="True-74-5"><a id="__codelineno-74-5" name="__codelineno-74-5" href="#__codelineno-74-5"></a>
</span><span id="True-74-6"><a id="__codelineno-74-6" name="__codelineno-74-6" href="#__codelineno-74-6"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">rest</span><span class="o">=</span><span class="n">empty</span><span class="p">):</span>
</span><span id="True-74-7"><a id="__codelineno-74-7" name="__codelineno-74-7" href="#__codelineno-74-7"></a>        <span class="k">assert</span> <span class="n">rest</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">Link</span><span class="p">)</span>
</span><span id="True-74-8"><a id="__codelineno-74-8" name="__codelineno-74-8" href="#__codelineno-74-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">=</span> <span class="n">first</span>
</span><span id="True-74-9"><a id="__codelineno-74-9" name="__codelineno-74-9" href="#__codelineno-74-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="n">rest</span>
</span><span id="True-74-10"><a id="__codelineno-74-10" name="__codelineno-74-10" href="#__codelineno-74-10"></a>
</span><span id="True-74-11"><a id="__codelineno-74-11" name="__codelineno-74-11" href="#__codelineno-74-11"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-74-12"><a id="__codelineno-74-12" name="__codelineno-74-12" href="#__codelineno-74-12"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">:</span>
</span><span id="True-74-13"><a id="__codelineno-74-13" name="__codelineno-74-13" href="#__codelineno-74-13"></a>            <span class="n">rest_repr</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
</span><span id="True-74-14"><a id="__codelineno-74-14" name="__codelineno-74-14" href="#__codelineno-74-14"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-74-15"><a id="__codelineno-74-15" name="__codelineno-74-15" href="#__codelineno-74-15"></a>            <span class="n">rest_repr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span id="True-74-16"><a id="__codelineno-74-16" name="__codelineno-74-16" href="#__codelineno-74-16"></a>        <span class="k">return</span> <span class="s1">&#39;Link(&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="n">rest_repr</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
</span><span id="True-74-17"><a id="__codelineno-74-17" name="__codelineno-74-17" href="#__codelineno-74-17"></a>
</span><span id="True-74-18"><a id="__codelineno-74-18" name="__codelineno-74-18" href="#__codelineno-74-18"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-74-19"><a id="__codelineno-74-19" name="__codelineno-74-19" href="#__codelineno-74-19"></a>        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span>
</span><span id="True-74-20"><a id="__codelineno-74-20" name="__codelineno-74-20" href="#__codelineno-74-20"></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
</span><span id="True-74-21"><a id="__codelineno-74-21" name="__codelineno-74-21" href="#__codelineno-74-21"></a>            <span class="n">string</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
</span><span id="True-74-22"><a id="__codelineno-74-22" name="__codelineno-74-22" href="#__codelineno-74-22"></a>            <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span>
</span><span id="True-74-23"><a id="__codelineno-74-23" name="__codelineno-74-23" href="#__codelineno-74-23"></a>        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span>
</span><span id="True-74-24"><a id="__codelineno-74-24" name="__codelineno-74-24" href="#__codelineno-74-24"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="True-74-25"><a id="__codelineno-74-25" name="__codelineno-74-25" href="#__codelineno-74-25"></a>        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="True-74-26"><a id="__codelineno-74-26" name="__codelineno-74-26" href="#__codelineno-74-26"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
</span><span id="True-74-27"><a id="__codelineno-74-27" name="__codelineno-74-27" href="#__codelineno-74-27"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-74-28"><a id="__codelineno-74-28" name="__codelineno-74-28" href="#__codelineno-74-28"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="True-74-29"><a id="__codelineno-74-29" name="__codelineno-74-29" href="#__codelineno-74-29"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-74-30"><a id="__codelineno-74-30" name="__codelineno-74-30" href="#__codelineno-74-30"></a>        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rest</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="manipulate_link">manipulate link<a class="headerlink" href="#manipulate_link" title="Permanent link">&para;</a></h4>
<p>by <strong>attribute assignment</strong> </p>
<p><img alt="" src="../link.png" /></p>
<p>make clear if you want to:
- <strong>modify</strong> an object
  <div class="highlight"><pre><span></span><code><span id="True-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">rest</span> <span class="o">=</span> <span class="o">...</span>     <span class="c1"># attribute assignment</span>
</span><span id="True-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="o">...</span>
</span><span id="True-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="p">(</span><span class="k">return</span> <span class="n">s</span><span class="p">)</span>
</span></code></pre></div>
- <strong>construct</strong> a new object
  <div class="highlight"><pre><span></span><code><span id="True-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="n">Link</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>   <span class="c1"># base case</span>
</span><span id="True-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>  <span class="k">return</span> <span class="o">...</span>      
</span><span id="True-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a><span class="k">return</span> <span class="n">Link</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>     <span class="c1"># construct</span>
</span></code></pre></div></p>
<h3 id="tree_class">Tree Class<a class="headerlink" href="#tree_class" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span id="True-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Tree</span><span class="p">:</span>
</span><span id="True-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">branches</span><span class="o">=</span><span class="p">[]):</span>
</span><span id="True-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="True-77-4"><a id="__codelineno-77-4" name="__codelineno-77-4" href="#__codelineno-77-4"></a>        <span class="k">for</span> <span class="n">branch</span> <span class="ow">in</span> <span class="n">branches</span><span class="p">:</span>
</span><span id="True-77-5"><a id="__codelineno-77-5" name="__codelineno-77-5" href="#__codelineno-77-5"></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">branch</span><span class="p">,</span> <span class="n">Tree</span><span class="p">)</span>
</span><span id="True-77-6"><a id="__codelineno-77-6" name="__codelineno-77-6" href="#__codelineno-77-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">branches</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">branches</span><span class="p">)</span>
</span><span id="True-77-7"><a id="__codelineno-77-7" name="__codelineno-77-7" href="#__codelineno-77-7"></a>
</span><span id="True-77-8"><a id="__codelineno-77-8" name="__codelineno-77-8" href="#__codelineno-77-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-77-9"><a id="__codelineno-77-9" name="__codelineno-77-9" href="#__codelineno-77-9"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="True-77-10"><a id="__codelineno-77-10" name="__codelineno-77-10" href="#__codelineno-77-10"></a>            <span class="k">return</span> <span class="s1">&#39;Tree(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">branches</span><span class="p">))</span>
</span><span id="True-77-11"><a id="__codelineno-77-11" name="__codelineno-77-11" href="#__codelineno-77-11"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-77-12"><a id="__codelineno-77-12" name="__codelineno-77-12" href="#__codelineno-77-12"></a>            <span class="k">return</span> <span class="s1">&#39;Tree(</span><span class="si">{0}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">))</span>
</span><span id="True-77-13"><a id="__codelineno-77-13" name="__codelineno-77-13" href="#__codelineno-77-13"></a>
</span><span id="True-77-14"><a id="__codelineno-77-14" name="__codelineno-77-14" href="#__codelineno-77-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="True-77-15"><a id="__codelineno-77-15" name="__codelineno-77-15" href="#__codelineno-77-15"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">branches</span>
</span></code></pre></div>
<h4 id="manipulate_tree">manipulate tree<a class="headerlink" href="#manipulate_tree" title="Permanent link">&para;</a></h4>
<blockquote>
<p>prune subtrees
<div class="highlight"><pre><span></span><code><span id="True-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">prune</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="True-78-2"><a id="__codelineno-78-2" name="__codelineno-78-2" href="#__codelineno-78-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;prune subtrees with label x</span>
</span><span id="True-78-3"><a id="__codelineno-78-3" name="__codelineno-78-3" href="#__codelineno-78-3"></a><span class="sd">    the root node will not be removed&quot;&quot;&quot;</span>
</span><span id="True-78-4"><a id="__codelineno-78-4" name="__codelineno-78-4" href="#__codelineno-78-4"></a>
</span><span id="True-78-5"><a id="__codelineno-78-5" name="__codelineno-78-5" href="#__codelineno-78-5"></a>    <span class="n">t</span><span class="o">.</span><span class="n">branches</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span> <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">x</span><span class="p">]</span>    <span class="c1"># attribute assignment</span>
</span><span id="True-78-6"><a id="__codelineno-78-6" name="__codelineno-78-6" href="#__codelineno-78-6"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="True-78-7"><a id="__codelineno-78-7" name="__codelineno-78-7" href="#__codelineno-78-7"></a>        <span class="n">prune</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></code></pre></div>
delete nodes
<div class="highlight"><pre><span></span><code><span id="True-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="True-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove all nodes labeled x below the root within Tree t. When a non-leaf</span>
</span><span id="True-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a><span class="sd">    node is deleted, the deleted node&#39;s children become children of its parent.</span>
</span><span id="True-79-4"><a id="__codelineno-79-4" name="__codelineno-79-4" href="#__codelineno-79-4"></a>
</span><span id="True-79-5"><a id="__codelineno-79-5" name="__codelineno-79-5" href="#__codelineno-79-5"></a><span class="sd">    The root node will never be removed.&quot;&quot;&quot;</span>
</span><span id="True-79-6"><a id="__codelineno-79-6" name="__codelineno-79-6" href="#__codelineno-79-6"></a>
</span><span id="True-79-7"><a id="__codelineno-79-7" name="__codelineno-79-7" href="#__codelineno-79-7"></a>    <span class="n">new_branches</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="True-79-8"><a id="__codelineno-79-8" name="__codelineno-79-8" href="#__codelineno-79-8"></a>    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">branches</span><span class="p">:</span>
</span><span id="True-79-9"><a id="__codelineno-79-9" name="__codelineno-79-9" href="#__codelineno-79-9"></a>        <span class="n">delete</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="True-79-10"><a id="__codelineno-79-10" name="__codelineno-79-10" href="#__codelineno-79-10"></a>        <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">x</span><span class="p">:</span>
</span><span id="True-79-11"><a id="__codelineno-79-11" name="__codelineno-79-11" href="#__codelineno-79-11"></a>            <span class="n">new_branches</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">branches</span>
</span><span id="True-79-12"><a id="__codelineno-79-12" name="__codelineno-79-12" href="#__codelineno-79-12"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="True-79-13"><a id="__codelineno-79-13" name="__codelineno-79-13" href="#__codelineno-79-13"></a>            <span class="n">new_branches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="True-79-14"><a id="__codelineno-79-14" name="__codelineno-79-14" href="#__codelineno-79-14"></a>    <span class="n">t</span><span class="o">.</span><span class="n">branches</span> <span class="o">=</span> <span class="n">new_branches</span>   <span class="c1"># attribute assignment</span>
</span></code></pre></div></p>
</blockquote>
<h3 id="sets">Sets<a class="headerlink" href="#sets" title="Permanent link">&para;</a></h3>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.expand", "navigation.sections", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../javascripts/mathjax-config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>